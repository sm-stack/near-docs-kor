"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5521],{90346:(e,t,n)=>{n.d(t,{Ey:()=>c,O2:()=>d,SQ:()=>p});var a=n(67294),r=n(74866),o=n(85162),l=n(1841),i=n.n(l),u=n(95665),s=n.n(u);function d(e){var t=e.children;return Array.isArray(t)||(t=[t]),a.createElement(r.Z,{className:"language-tabs",groupId:"code-tabs"},t.map((function(e,t){return a.createElement(o.Z,{value:e.props.value,label:e.props.value},e)})))}function p(e){var t=e.children,n=e.language;return Array.isArray(t)||(t=[t]),t=t.map((function(e){return function(e,t){var n=e.props,r=n.children,o=n.url,l=n.start,u=n.end,s=n.fname;if("Github"==e.props.mdxType)return c({url:o,start:l,end:u,language:t,fname:s});if("CodeBlock"==e.props.mdxType)return a.createElement(i(),{fname:s,language:t},r);return e}(e,n)})),1==t.length?a.createElement(o.Z,{value:0,label:t[0].props.fname},t[0]):a.createElement(r.Z,{className:"file-tabs"},t.map((function(e,t){return a.createElement(o.Z,{value:t,label:e.props.fname},e)})))}function c(e){var t=e.url,n=e.start,r=e.end,o=e.language,l=e.fname,i=t+"#";return n&&r&&(i+="L"+n+"-L"+r+"#"),a.createElement(s(),{language:o,fname:l},i)}},85162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(67294),r=n(86010);const o="tabItem_Ymn6";function l(e){var t=e.children,n=e.hidden,l=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,l),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(87462),r=n(67294),o=n(86010),l=n(12466),i=n(76775),u=n(91980),s=n(67392),d=n(50012);function p(e){return function(e){return r.Children.map(e,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))}(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}function c(e){var t=e.values,n=e.children;return(0,r.useMemo)((function(){var e=null!=t?t:p(n);return function(e){var t=(0,s.l)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function m(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function h(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId,o=(0,i.k6)(),l=function(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:n,groupId:a});return[(0,u._X)(l),(0,r.useCallback)((function(e){if(l){var t=new URLSearchParams(o.location.search);t.set(l,e),o.replace(Object.assign({},o.location,{search:t.toString()}))}}),[l,o])]}function g(e){var t,n,a,o,l=e.defaultValue,i=e.queryString,u=void 0!==i&&i,s=e.groupId,p=c(e),g=(0,r.useState)((function(){return function(e){var t,n=e.defaultValue,a=e.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var r=null!=(t=a.find((function(e){return e.default})))?t:a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:l,tabValues:p})})),k=g[0],b=g[1],f=h({queryString:u,groupId:s}),v=f[0],y=f[1],N=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:s}.groupId),n=(0,d.Nk)(t),a=n[0],o=n[1],[a,(0,r.useCallback)((function(e){t&&o.set(e)}),[t,o])]),w=N[0],x=N[1],C=function(){var e=null!=v?v:w;return m({value:e,tabValues:p})?e:null}();return(0,r.useLayoutEffect)((function(){C&&b(C)}),[C]),{selectedValue:k,selectValue:(0,r.useCallback)((function(e){if(!m({value:e,tabValues:p}))throw new Error("Can't select invalid tab value="+e);b(e),y(e),x(e)}),[y,x,p]),tabValues:p}}var k=n(72389);const b="tabList__CuJ",f="tabItem_LNqP";function v(e){var t=e.className,n=e.block,i=e.selectedValue,u=e.selectValue,s=e.tabValues,d=[],p=(0,l.o5)().blockElementScrollPositionUntilNextRender,c=function(e){var t=e.currentTarget,n=d.indexOf(t),a=s[n].value;a!==i&&(p(t),u(a))},m=function(e){var t,n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":var a,r=d.indexOf(e.currentTarget)+1;n=null!=(a=d[r])?a:d[0];break;case"ArrowLeft":var o,l=d.indexOf(e.currentTarget)-1;n=null!=(o=d[l])?o:d[d.length-1]}null==(t=n)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},s.map((function(e){var t=e.value,n=e.label,l=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:function(e){return d.push(e)},onKeyDown:m,onClick:c},l,{className:(0,o.Z)("tabs__item",f,null==l?void 0:l.className,{"tabs__item--active":i===t})}),null!=n?n:t)})))}function y(e){var t=e.lazy,n=e.children,a=e.selectedValue;if(n=Array.isArray(n)?n:[n],t){var o=n.find((function(e){return e.props.value===a}));return o?(0,r.cloneElement)(o,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a})})))}function N(e){var t=g(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",b)},r.createElement(v,(0,a.Z)({},e,t)),r.createElement(y,(0,a.Z)({},e,t)))}function w(e){var t=(0,k.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}},16351:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>k,frontMatter:()=>d,metadata:()=>c,toc:()=>h});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),l=n(74866),i=n(85162),u=n(90346),s=["components"],d={id:"count-near",title:"Count on NEAR"},p=void 0,c={unversionedId:"tutorials/examples/count-near",id:"tutorials/examples/count-near",title:"Count on NEAR",description:"Our counter example is a friendly decentralized app that stores a number and exposes methods to increment,",source:"@site/../docs/3.tutorials/examples/count-near.md",sourceDirName:"3.tutorials/examples",slug:"/tutorials/examples/count-near",permalink:"/near-docs-kor/zh-CN/tutorials/examples/count-near",draft:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/3.tutorials/examples/count-near.md",tags:[],version:"current",lastUpdatedBy:"[sm-stack]",lastUpdatedAt:1675844989,formattedLastUpdatedAt:"2023\u5e742\u67088\u65e5",frontMatter:{id:"count-near",title:"Count on NEAR"},sidebar:"tutorials",previous:{title:"Hello NEAR",permalink:"/near-docs-kor/zh-CN/tutorials/examples/hello-near"},next:{title:"Guest Book",permalink:"/near-docs-kor/zh-CN/tutorials/examples/guest-book"}},m={},h=[{value:"Starting the Counter",id:"starting-the-counter",level:2},{value:"Interacting With the Counter",id:"interacting-with-the-counter",level:2},{value:"Structure of a dApp",id:"structure-of-a-dapp",level:2},{value:"Contract",id:"contract",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Testing",id:"testing",level:2},{value:"Unit test",id:"unit-test",level:3},{value:"Integration test",id:"integration-test",level:3},{value:"Moving Forward",id:"moving-forward",level:2}],g={toc:h};function k(e){var t=e.components,d=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},g,d,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Our counter example is a friendly decentralized app that stores a number and exposes methods to ",(0,o.kt)("inlineCode",{parentName:"p"},"increment"),",\n",(0,o.kt)("inlineCode",{parentName:"p"},"decrement"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"reset")," it."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"img",src:n(13584).Z,width:"935",height:"248"})),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"starting-the-counter"},"Starting the Counter"),(0,o.kt)("p",null,"You have two options to start the Counter:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Recommended:")," use the app through Gitpod (a web-based interactive environment)"),(0,o.kt)("li",{parentName:"ol"},"Clone the project locally .")),(0,o.kt)(l.Z,{className:"language-tabs",groupId:"code-tabs",mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"\ud83c\udf10 JavaScript",mdxType:"TabItem"},(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,o.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/js-counter.git"},(0,o.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,o.kt)("td",{parentName:"tr",align:null},"\ud83c\udf10 ",(0,o.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/js-counter.git")))))),(0,o.kt)(i.Z,{value:"\ud83e\udd80 Rust",mdxType:"TabItem"},(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,o.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/rust-counter.git"},(0,o.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,o.kt)("td",{parentName:"tr",align:null},"\ud83e\udd80 ",(0,o.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/rust-counter.git")))))),(0,o.kt)(i.Z,{value:"\ud83d\ude80 AssemblyScript",mdxType:"TabItem"},(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,o.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/counter.git"},(0,o.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,o.kt)("td",{parentName:"tr",align:null},"\ud83d\ude80 ",(0,o.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/counter.git"))))))),(0,o.kt)("p",null,"If you choose Gitpod, a new browser window will open automatically with the code. Give it a minute, and the frontend will pop up (ensure the pop-up window is not blocked)."),(0,o.kt)("p",null,"If you are running the app locally, enter the directory where you cloned it and use ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn")," to install dependencies, and ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn start")," to start it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd counter\nyarn\nyarn deploy\nyarn start\n")),(0,o.kt)("p",null,"Your contract will then be ",(0,o.kt)("strong",{parentName:"p"},"compiled")," and ",(0,o.kt)("strong",{parentName:"p"},"deployed")," to an ",(0,o.kt)("strong",{parentName:"p"},"account")," in the ",(0,o.kt)("inlineCode",{parentName:"p"},"testnet")," network. When done, a browser window should open."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"interacting-with-the-counter"},"Interacting With the Counter"),(0,o.kt)("p",null,"Go ahead and login with your NEAR account. If you don't have one, you will be able to create one in the moment. Once logged in, use the ",(0,o.kt)("inlineCode",{parentName:"p"},"+")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"-")," buttons to increase and decrease the counter. Then, use the Gameboy buttons to reset it and make the counter blink an eye!"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"img",src:n(64447).Z,width:"935",height:"526"}),"\n",(0,o.kt)("em",{parentName:"p"},"Frontend of the Counter")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"structure-of-a-dapp"},"Structure of a dApp"),(0,o.kt)("p",null,"Now that you understand what the dApp does, let us take a closer look to its structure:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The frontend code lives in the ",(0,o.kt)("inlineCode",{parentName:"li"},"/frontend")," folder."),(0,o.kt)("li",{parentName:"ol"},"The smart contract code is in the ",(0,o.kt)("inlineCode",{parentName:"li"},"/contract")," folder.")),(0,o.kt)("h3",{id:"contract"},"Contract"),(0,o.kt)("p",null,"The contract presents 4 methods: ",(0,o.kt)("inlineCode",{parentName:"p"},"get_num"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"increment"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"decrement"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"reset"),". The method ",(0,o.kt)("inlineCode",{parentName:"p"},"get_num")," retrieves the current value, and the rest modify it."),(0,o.kt)(u.O2,{mdxType:"CodeTabs"},(0,o.kt)(u.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/js-counter/blob/master/contract/src/contract.ts",start:"3",end:"29",mdxType:"Github"})),(0,o.kt)(u.SQ,{value:"\ud83e\udd80 Rust",language:"rust",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"lib.rs",url:"https://github.com/near-examples/rust-counter/blob/master/contract/src/lib.rs",start:"5",end:"36",mdxType:"Github"})),(0,o.kt)(u.SQ,{value:"\ud83d\ude80 AssemblyScript",language:"ts",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"index.ts",url:"https://github.com/near-examples/counter/blob/master/contract/assembly/index.ts",mdxType:"Github"}))),(0,o.kt)("h3",{id:"frontend"},"Frontend"),(0,o.kt)("p",null,"The frontend is composed by a single HTML file (",(0,o.kt)("inlineCode",{parentName:"p"},"/index.html"),"). This file defines the components displayed in the screen."),(0,o.kt)("p",null,"The website's logic lives in ",(0,o.kt)("inlineCode",{parentName:"p"},"/assets/js/index.js"),", which communicates with the contract through ",(0,o.kt)("inlineCode",{parentName:"p"},"/near-interface.js"),". You will notice in ",(0,o.kt)("inlineCode",{parentName:"p"},"/assets/js/index.js")," the following code:"),(0,o.kt)(u.O2,{mdxType:"CodeTabs"},(0,o.kt)(u.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"index.js",url:"https://github.com/near-examples/js-counter/blob/master/frontend/index.js",start:"10",end:"21",mdxType:"Github"}))),(0,o.kt)("p",null,"It indicates our app, when it starts, to check if the user is already logged in and execute either ",(0,o.kt)("inlineCode",{parentName:"p"},"signedInFlow()")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"signedOutFlow()"),"."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"testing"},"Testing"),(0,o.kt)("p",null,"When writing smart contracts it is very important to test all methods exhaustively. In this\nproject you have two types of tests: unit and integration. Before digging in them,\ngo ahead and perform the tests present in the dApp through the command ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn test"),"."),(0,o.kt)("h3",{id:"unit-test"},"Unit test"),(0,o.kt)("p",null,"Unit tests check individual functions in the smart contract. Right now only Rust implements unit testing. "),(0,o.kt)(u.O2,{mdxType:"CodeTabs"},(0,o.kt)(u.SQ,{value:"\ud83e\udd80 Rust",language:"rust",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"lib.rs",url:"https://github.com/near-examples/rust-counter/blob/master/contract/src/lib.rs",start:"48",end:"69",mdxType:"Github"})),(0,o.kt)(u.SQ,{value:"\ud83d\ude80 AssemblyScript",language:"ts",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"main.spec.ts",url:"https://github.com/near-examples/counter/blob/master/contract/assembly/__tests__/main.spec.ts",start:"5",end:"44",mdxType:"Github"}))),(0,o.kt)("h3",{id:"integration-test"},"Integration test"),(0,o.kt)("p",null,"Integration tests are generally written in javascript. They automatically deploy a new\ncontract and execute methods on it. In this way, integration tests simulate interactions\nfrom users in a realistic scenario. You will find the integration tests for the ",(0,o.kt)("inlineCode",{parentName:"p"},"counter"),"\nin ",(0,o.kt)("inlineCode",{parentName:"p"},"tests/integration-tests"),"."),(0,o.kt)(u.O2,{mdxType:"CodeTabs"},(0,o.kt)(u.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,o.kt)(u.Ey,{fname:"main.test.js",url:"https://github.com/near-examples/js-counter/blob/master/integration-tests/src/main.ava.ts",start:"37",end:"61",mdxType:"Github"}))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"moving-forward"},"Moving Forward"),(0,o.kt)("p",null,"A nice way to learn is by trying to expand the contract. Modify it by adding a parameter to ",(0,o.kt)("inlineCode",{parentName:"p"},"increment")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"decrement"),",\nso the user can choose by how much to change the value. For this, you will need to use knowledge from the ",(0,o.kt)("a",{parentName:"p",href:"/near-docs-kor/zh-CN/develop/contracts/anatomy"},"anatomy"),"\nand ",(0,o.kt)("a",{parentName:"p",href:"/near-docs-kor/zh-CN/develop/contracts/storage"},"storage")," sections."))}k.isMDXComponent=!0},13584:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/count-on-near-banner-2df2978ef988be400aafd5e0f99878be.png"},64447:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/count-on-near-4c3bca89fb498ba9e02547eeb320d02a.png"}}]);