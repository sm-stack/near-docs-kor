"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[993],{90346:(t,e,n)=>{n.d(e,{Ey:()=>m,O2:()=>d,SQ:()=>p});var a=n(67294),o=n(65488),r=n(85162),l=n(1841),i=n.n(l),s=n(95665),u=n.n(s);function d(t){var e=t.children;return Array.isArray(e)||(e=[e]),a.createElement(o.Z,{className:"language-tabs",groupId:"code-tabs"},e.map((function(t,e){return a.createElement(r.Z,{value:t.props.value,label:t.props.value},t)})))}function p(t){var e=t.children,n=t.language;return Array.isArray(e)||(e=[e]),e=e.map((function(t){return function(t,e){var n=t.props,o=n.children,r=n.url,l=n.start,s=n.end,u=n.fname;if("Github"==t.props.mdxType)return m({url:r,start:l,end:s,language:e,fname:u});if("CodeBlock"==t.props.mdxType)return a.createElement(i(),{fname:u,language:e},o);return t}(t,n)})),1==e.length?a.createElement(r.Z,{value:0,label:e[0].props.fname},e[0]):a.createElement(o.Z,{className:"file-tabs"},e.map((function(t,e){return a.createElement(r.Z,{value:e,label:t.props.fname},t)})))}function m(t){var e=t.url,n=t.start,o=t.end,r=t.language,l=t.fname,i=e+"#";return n&&o&&(i+="L"+n+"-L"+o+"#"),a.createElement(u(),{language:r,fname:l},i)}},85162:(t,e,n)=>{n.d(e,{Z:()=>l});var a=n(67294),o=n(86010);const r="tabItem_Ymn6";function l(t){var e=t.children,n=t.hidden,l=t.className;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r,l),hidden:n},e)}},65488:(t,e,n)=>{n.d(e,{Z:()=>c});var a=n(87462),o=n(67294),r=n(86010),l=n(72389),i=n(67392),s=n(7094),u=n(12466);const d="tabList__CuJ",p="tabItem_LNqP";function m(t){var e,n,l=t.lazy,m=t.block,c=t.defaultValue,h=t.values,g=t.groupId,b=t.className,k=o.Children.map(t.children,(function(t){if((0,o.isValidElement)(t)&&"value"in t.props)return t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof t.type?t.type:t.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),f=null!=h?h:k.map((function(t){var e=t.props;return{value:e.value,label:e.label,attributes:e.attributes}})),v=(0,i.l)(f,(function(t,e){return t.value===e.value}));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((function(t){return t.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===c?c:null!=(e=null!=c?c:null==(n=k.find((function(t){return t.props.default})))?void 0:n.props.value)?e:k[0].props.value;if(null!==y&&!f.some((function(t){return t.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+f.map((function(t){return t.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var x=(0,s.U)(),w=x.tabGroupChoices,N=x.setTabGroupChoices,T=(0,o.useState)(y),E=T[0],C=T[1],A=[],j=(0,u.o5)().blockElementScrollPositionUntilNextRender;if(null!=g){var I=w[g];null!=I&&I!==E&&f.some((function(t){return t.value===I}))&&C(I)}var S=function(t){var e=t.currentTarget,n=A.indexOf(e),a=f[n].value;a!==E&&(j(e),C(a),null!=g&&N(g,String(a)))},Z=function(t){var e,n=null;switch(t.key){case"ArrowRight":var a,o=A.indexOf(t.currentTarget)+1;n=null!=(a=A[o])?a:A[0];break;case"ArrowLeft":var r,l=A.indexOf(t.currentTarget)-1;n=null!=(r=A[l])?r:A[A.length-1]}null==(e=n)||e.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",d)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":m},b)},f.map((function(t){var e=t.value,n=t.label,l=t.attributes;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:E===e?0:-1,"aria-selected":E===e,key:e,ref:function(t){return A.push(t)},onKeyDown:Z,onFocus:S,onClick:S},l,{className:(0,r.Z)("tabs__item",p,null==l?void 0:l.className,{"tabs__item--active":E===e})}),null!=n?n:e)}))),l?(0,o.cloneElement)(k.filter((function(t){return t.props.value===E}))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},k.map((function(t,e){return(0,o.cloneElement)(t,{key:e,hidden:t.props.value!==E})}))))}function c(t){var e=(0,l.Z)();return o.createElement(m,(0,a.Z)({key:String(e)},t))}},40075:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>p,default:()=>b,frontMatter:()=>d,metadata:()=>m,toc:()=>h});var a=n(87462),o=n(63366),r=(n(67294),n(3905)),l=n(65488),i=n(85162),s=n(90346),u=["components"],d={id:"donation",title:"Donation"},p=void 0,m={unversionedId:"tutorials/examples/donation",id:"tutorials/examples/donation",title:"Donation",description:"",source:"@site/../docs/3.tutorials/examples/donation.md",sourceDirName:"3.tutorials/examples",slug:"/tutorials/examples/donation",permalink:"/tutorials/examples/donation",draft:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/3.tutorials/examples/donation.md",tags:[],version:"current",lastUpdatedBy:"[sm-stack]",lastUpdatedAt:1675844989,formattedLastUpdatedAt:"Feb 8, 2023",frontMatter:{id:"donation",title:"Donation"},sidebar:"tutorials",previous:{title:"Guest Book",permalink:"/tutorials/examples/guest-book"},next:{title:"Cross Contract Call",permalink:"/tutorials/examples/xcc"}},c={},h=[{value:"Starting the Donation Example",id:"starting-the-donation-example",level:2},{value:"Interacting With the dApp",id:"interacting-with-the-dapp",level:2},{value:"Structure of a dApp",id:"structure-of-a-dapp",level:2},{value:"Contract",id:"contract",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Testing",id:"testing",level:2},{value:"Unit test",id:"unit-test",level:3},{value:"Integration test",id:"integration-test",level:3},{value:"Moving Forward",id:"moving-forward",level:2}],g={toc:h};function b(t){var e=t.components,d=(0,o.Z)(t,u);return(0,r.kt)("wrapper",(0,a.Z)({},g,d,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Our donation example enables to forward money to an account while keeping track of it.\nIt is one of the simplest examples on making a contract receive and send money, and the\nperfect gateway to enter the world of decentralized finance."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(12257).Z,width:"1139",height:"479"})),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"starting-the-donation-example"},"Starting the Donation Example"),(0,r.kt)("p",null,"You have two options to start the Donation Example. The first and recommended is to use the app through Gitpod, which will open a web-based interactive environment. The second option is to clone the repository locally, for which you will need to install all the ",(0,r.kt)("a",{parentName:"p",href:"/develop/prerequisites"},"Prerequisites"),"."),(0,r.kt)(l.Z,{className:"language-tabs",groupId:"code-tabs",mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"\ud83c\udf10 JavaScript",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,r.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/donation-js"},(0,r.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,r.kt)("td",{parentName:"tr",align:null},"\ud83c\udf10 ",(0,r.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/donation-js.git")))))),(0,r.kt)(i.Z,{value:"\ud83e\udd80 Rust",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,r.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/donation-rust"},(0,r.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,r.kt)("td",{parentName:"tr",align:null},"\ud83e\udd80 ",(0,r.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/donation-rust.git")))))),(0,r.kt)(i.Z,{value:"\ud83d\ude80 AssemblyScript",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,r.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/docs-examples/blob/main/donation-as"},(0,r.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,r.kt)("td",{parentName:"tr",align:null},"\ud83d\ude80 ",(0,r.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/docs-examples")," -> donation-as")))))),(0,r.kt)("p",null,"If you choose Gitpod a new browser window will open automatically with the code. The project will compile and eventually the frontend will open in a new window/tab (make sure the pop-up window is not blocked)."),(0,r.kt)("p",null,"If you are running the app locally, enter the directory where you cloned it and use ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn")," to install dependencies, and ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn start")," to start it."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd donation\nyarn\nyarn deploy\nyarn start\n")),(0,r.kt)("p",null,"Your contract will then be ",(0,r.kt)("strong",{parentName:"p"},"compiled")," and ",(0,r.kt)("strong",{parentName:"p"},"deployed")," to an ",(0,r.kt)("strong",{parentName:"p"},"account")," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"testnet")," network. When done, a browser window should open."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"interacting-with-the-dapp"},"Interacting With the dApp"),(0,r.kt)("p",null,'Go ahead and login with your NEAR account. If you don\'t have one, you will be able to create one in the moment. Once logged in, input the amount of NEAR you want\nto donate and press the donate button. You will be redirected to the NEAR Wallet to confirm the transaction. After confirming it, the donation will be listed\nin the "Latest Donations".'),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(12257).Z,width:"1139",height:"479"}),"\n",(0,r.kt)("em",{parentName:"p"},"Frontend of the Donation App")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"structure-of-a-dapp"},"Structure of a dApp"),(0,r.kt)("p",null,"Now that you understand what the dApp does, let us take a closer look to its structure:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The frontend code lives in the ",(0,r.kt)("inlineCode",{parentName:"li"},"/frontend")," folder."),(0,r.kt)("li",{parentName:"ol"},"The smart contract code is in the ",(0,r.kt)("inlineCode",{parentName:"li"},"/contract")," folder.")),(0,r.kt)("h3",{id:"contract"},"Contract"),(0,r.kt)("p",null,"The contract exposes methods to donate money (",(0,r.kt)("inlineCode",{parentName:"p"},"donate"),"), and methods to retrieve the recorded donations (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"get_donation_by_number"),")."),(0,r.kt)(s.O2,{mdxType:"CodeTabs"},(0,r.kt)(s.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/donation-js/blob/master/contract/src/contract.ts",start:"16",end:"44",mdxType:"Github"})),(0,r.kt)(s.SQ,{value:"\ud83e\udd80 Rust",language:"rust",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"lib.rs",url:"https://github.com/near-examples/donation-rust/blob/main/contract/src/donation.rs",start:"21",end:"50",mdxType:"Github"})),(0,r.kt)(s.SQ,{value:"\ud83d\ude80 AssemblyScript",language:"ts",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"index.ts",url:"https://github.com/near-examples/docs-examples/blob/main/donation-as/contract/assembly/index.ts",start:"11",end:"34",mdxType:"Github"}))),(0,r.kt)("h3",{id:"frontend"},"Frontend"),(0,r.kt)("p",null,"The frontend is composed by a single HTML file (",(0,r.kt)("inlineCode",{parentName:"p"},"/index.html"),"). This file defines the components displayed in the screen.\nThe website's logic lives in ",(0,r.kt)("inlineCode",{parentName:"p"},"/assets/js/index.js"),", which communicates with the contract through ",(0,r.kt)("inlineCode",{parentName:"p"},"/assets/js/near/utils.js"),"."),(0,r.kt)("p",null,"An interesting aspect of the donation example is that it showcases how to retrieve a result after being redirected to the\nNEAR wallet to accept a transaction."),(0,r.kt)(s.O2,{mdxType:"CodeTabs"},(0,r.kt)(s.SQ,{value:"\ud83c\udf10 JavaScript",language:"js",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"index.js",url:"https://github.com/near-examples/donation-js/blob/master/frontend/index.js",start:"74",end:"81",mdxType:"Github"}),(0,r.kt)(s.Ey,{fname:"near-interface.js",url:"https://github.com/near-examples/donation-js/blob/master/frontend/near-interface.js",start:"29",end:"32",mdxType:"Github"}),(0,r.kt)(s.Ey,{fname:"near-wallet.js",url:"https://github.com/near-examples/donation-js/blob/master/frontend/near-wallet.js",start:"105",end:"113",mdxType:"Github"}))),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"testing"},"Testing"),(0,r.kt)("p",null,"When writing smart contracts it is very important to test all methods exhaustively. In this\nproject you have two types of tests: unit and integration. Before digging in them,\ngo ahead and perform the tests present in the dApp through the command ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn test"),"."),(0,r.kt)("h3",{id:"unit-test"},"Unit test"),(0,r.kt)("p",null,"Unit tests check individual functions in the smart contract. They are written in the\nsame language as the smart contract is. "),(0,r.kt)(s.O2,{mdxType:"CodeTabs"},(0,r.kt)(s.SQ,{value:"\ud83e\udd80 Rust",language:"rust",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"lib.rs",url:"https://github.com/near-examples/donation-rust/blob/main/contract/src/lib.rs",start:"63",end:"92",mdxType:"Github"})),(0,r.kt)(s.SQ,{value:"\ud83d\ude80 AssemblyScript",language:"ts",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"main.spec.ts",url:"https://github.com/near-examples/docs-examples/blob/main/donation-as/contract/assembly/__tests__/donation.spec.ts",start:"16",end:"43",mdxType:"Github"}))),(0,r.kt)("h3",{id:"integration-test"},"Integration test"),(0,r.kt)("p",null,"Integration tests are generally written in javascript. They automatically deploy a new\ncontract and execute methods on it. In this way, integration tests simulate interactions\nfrom users in a realistic scenario. You will find the integration tests\nin ",(0,r.kt)("inlineCode",{parentName:"p"},"tests/integration-tests"),"."),(0,r.kt)(s.O2,{mdxType:"CodeTabs"},(0,r.kt)(s.SQ,{value:"\ud83c\udf10 JavaScript",language:"rust",mdxType:"Language"},(0,r.kt)(s.Ey,{fname:"main.test.js",url:"https://github.com/near-examples/donation-js/blob/master/integration-tests/src/main.ava.ts",start:"50",end:"73",mdxType:"Github"}))),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"moving-forward"},"Moving Forward"),(0,r.kt)("p",null,"A nice way to learn is by trying to expand a contract. Modify the donation example so it accumulates the money in the contract\ninstead of sending it immediately. Then, make a method that only the ",(0,r.kt)("inlineCode",{parentName:"p"},"beneficiary")," can call to retrieve the money."))}b.isMDXComponent=!0},12257:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/donation-7cf65e5e131274fd1ae9aa34bc465bb8.png"}}]);