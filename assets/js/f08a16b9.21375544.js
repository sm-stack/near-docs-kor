"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8157],{90346:(e,t,n)=>{n.d(t,{Ey:()=>d,O2:()=>p,SQ:()=>c});var a=n(67294),r=n(65488),l=n(85162),i=n(1841),o=n.n(i),s=n(95665),u=n.n(s);function p(e){var t=e.children;return Array.isArray(t)||(t=[t]),a.createElement(r.Z,{className:"language-tabs",groupId:"code-tabs"},t.map((function(e,t){return a.createElement(l.Z,{value:e.props.value,label:e.props.value},e)})))}function c(e){var t=e.children,n=e.language;return Array.isArray(t)||(t=[t]),t=t.map((function(e){return function(e,t){var n=e.props,r=n.children,l=n.url,i=n.start,s=n.end,u=n.fname;if("Github"==e.props.mdxType)return d({url:l,start:i,end:s,language:t,fname:u});if("CodeBlock"==e.props.mdxType)return a.createElement(o(),{fname:u,language:t},r);return e}(e,n)})),1==t.length?a.createElement(l.Z,{value:0,label:t[0].props.fname},t[0]):a.createElement(r.Z,{className:"file-tabs"},t.map((function(e,t){return a.createElement(l.Z,{value:t,label:e.props.fname},e)})))}function d(e){var t=e.url,n=e.start,r=e.end,l=e.language,i=e.fname,o=t+"#";return n&&r&&(o+="L"+n+"-L"+r+"#"),a.createElement(u(),{language:l,fname:i},o)}},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294),r=n(86010);const l="tabItem_Ymn6";function i(e){var t=e.children,n=e.hidden,i=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,i),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(87462),r=n(67294),l=n(86010),i=n(72389),o=n(67392),s=n(7094),u=n(12466);const p="tabList__CuJ",c="tabItem_LNqP";function d(e){var t,n,i=e.lazy,d=e.block,m=e.defaultValue,h=e.values,g=e.groupId,f=e.className,k=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),v=null!=h?h:k.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),b=(0,o.l)(v,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===m?m:null!=(t=null!=m?m:null==(n=k.find((function(e){return e.props.default})))?void 0:n.props.value)?t:k[0].props.value;if(null!==y&&!v.some((function(e){return e.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+v.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var w=(0,s.U)(),N=w.tabGroupChoices,x=w.setTabGroupChoices,C=(0,r.useState)(y),T=C[0],E=C[1],I=[],Z=(0,u.o5)().blockElementScrollPositionUntilNextRender;if(null!=g){var j=N[g];null!=j&&j!==T&&v.some((function(e){return e.value===j}))&&E(j)}var S=function(e){var t=e.currentTarget,n=I.indexOf(t),a=v[n].value;a!==T&&(Z(t),E(a),null!=g&&x(g,String(a)))},A=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a,r=I.indexOf(e.currentTarget)+1;n=null!=(a=I[r])?a:I[0];break;case"ArrowLeft":var l,i=I.indexOf(e.currentTarget)-1;n=null!=(l=I[i])?l:I[I.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:(0,l.Z)("tabs-container",p)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":d},f)},v.map((function(e){var t=e.value,n=e.label,i=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:T===t?0:-1,"aria-selected":T===t,key:t,ref:function(e){return I.push(e)},onKeyDown:A,onFocus:S,onClick:S},i,{className:(0,l.Z)("tabs__item",c,null==i?void 0:i.className,{"tabs__item--active":T===t})}),null!=n?n:t)}))),i?(0,r.cloneElement)(k.filter((function(e){return e.props.value===T}))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},k.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==T})}))))}function m(e){var t=(0,i.Z)();return r.createElement(d,(0,a.Z)({key:String(t)},e))}},46561:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>c,default:()=>f,frontMatter:()=>p,metadata:()=>d,toc:()=>h});var a=n(87462),r=n(63366),l=(n(67294),n(3905)),i=n(65488),o=n(85162),s=n(90346),u=["components"],p={id:"coin-flip",title:"Coin Flip"},c=void 0,d={unversionedId:"tutorials/examples/coin-flip",id:"tutorials/examples/coin-flip",title:"Coin Flip",description:"",source:"@site/../docs/3.tutorials/examples/coin-flip.md",sourceDirName:"3.tutorials/examples",slug:"/tutorials/examples/coin-flip",permalink:"/tutorials/examples/coin-flip",draft:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/3.tutorials/examples/coin-flip.md",tags:[],version:"current",lastUpdatedBy:"[sm-stack]",lastUpdatedAt:1675844989,formattedLastUpdatedAt:"Feb 8, 2023",frontMatter:{id:"coin-flip",title:"Coin Flip"},sidebar:"tutorials",previous:{title:"Cross Contract Call",permalink:"/tutorials/examples/xcc"},next:{title:"Factory",permalink:"/tutorials/examples/factory"}},m={},h=[{value:"Starting the Game",id:"starting-the-game",level:2},{value:"Interacting With the Counter",id:"interacting-with-the-counter",level:2},{value:"Structure of a dApp",id:"structure-of-a-dapp",level:2},{value:"Contract",id:"contract",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Testing",id:"testing",level:2},{value:"Integration test",id:"integration-test",level:3},{value:"A Note On Randomness",id:"a-note-on-randomness",level:2}],g={toc:h};function f(e){var t=e.components,p=(0,r.Z)(e,u);return(0,l.kt)("wrapper",(0,a.Z)({},g,p,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Coin Flip is a game where the player tries to guess the outcome of a coin flip. It is one of the simplest contracts implementing random numbers."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"img",src:n(79199).Z,width:"960",height:"255"})),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"starting-the-game"},"Starting the Game"),(0,l.kt)("p",null,"You have two options to start the example:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"Recommended:")," use the app through Gitpod (a web-based interactive environment)"),(0,l.kt)("li",{parentName:"ol"},"Clone the project locally .")),(0,l.kt)(i.Z,{className:"language-tabs",groupId:"code-tabs",mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"\ud83c\udf10 JavaScript",mdxType:"TabItem"},(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Gitpod"),(0,l.kt)("th",{parentName:"tr",align:null},"Clone locally"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{href:"https://gitpod.io/#https://github.com/near-examples/coin-flip-js.git"},(0,l.kt)("img",{src:"https://gitpod.io/button/open-in-gitpod.svg",alt:"Open in Gitpod"}))),(0,l.kt)("td",{parentName:"tr",align:null},"\ud83c\udf10 ",(0,l.kt)("inlineCode",{parentName:"td"},"https://github.com/near-examples/coin-flip-js.git"))))))),(0,l.kt)("p",null,"If you choose Gitpod, a new browser window will open automatically with the code. Give it a minute, and the front-end will pop up (ensure the pop-up window is not blocked)."),(0,l.kt)("p",null,"If you are running the app locally, enter the directory where you cloned it and use ",(0,l.kt)("inlineCode",{parentName:"p"},"yarn")," to install dependencies, and ",(0,l.kt)("inlineCode",{parentName:"p"},"yarn start")," to start it."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd coin-flip-js\nyarn\nyarn deploy\nyarn start\n")),(0,l.kt)("p",null,"Your contract will then be ",(0,l.kt)("strong",{parentName:"p"},"compiled")," and ",(0,l.kt)("strong",{parentName:"p"},"deployed")," to an ",(0,l.kt)("strong",{parentName:"p"},"account")," in the ",(0,l.kt)("inlineCode",{parentName:"p"},"testnet")," network. When done, a browser window should open."),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"interacting-with-the-counter"},"Interacting With the Counter"),(0,l.kt)("p",null,"Go ahead and log in with your NEAR account. If you don't have one, you can create one on the fly. Once logged in, use the ",(0,l.kt)("inlineCode",{parentName:"p"},"tails")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"heads")," buttons to try to guess the next coin flip outcome."),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"img",src:n(79199).Z,width:"960",height:"255"}),"\n",(0,l.kt)("em",{parentName:"p"},"Frontend of the Game")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"structure-of-a-dapp"},"Structure of a dApp"),(0,l.kt)("p",null,"Now that you understand what the dApp does, let us take a closer look to its structure:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The frontend code lives in the ",(0,l.kt)("inlineCode",{parentName:"li"},"/frontend")," folder."),(0,l.kt)("li",{parentName:"ol"},"The smart contract code is in the ",(0,l.kt)("inlineCode",{parentName:"li"},"/contract")," folder.")),(0,l.kt)("h3",{id:"contract"},"Contract"),(0,l.kt)("p",null,"The contract presents 2 methods: ",(0,l.kt)("inlineCode",{parentName:"p"},"flip_coin"),", and ",(0,l.kt)("inlineCode",{parentName:"p"},"points_of"),"."),(0,l.kt)(s.O2,{mdxType:"CodeTabs"},(0,l.kt)(s.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,l.kt)(s.Ey,{fname:"contract.ts",url:"https://github.com/near-examples/coin-flip-workshop-js/blob/main/contract/src/contract.ts",start:"23",end:"56",mdxType:"Github"}))),(0,l.kt)("h3",{id:"frontend"},"Frontend"),(0,l.kt)("p",null,"The frontend is composed by a single HTML file (",(0,l.kt)("inlineCode",{parentName:"p"},"/index.html"),"). This file defines the components displayed in the screen."),(0,l.kt)("p",null,"The website's logic lives in ",(0,l.kt)("inlineCode",{parentName:"p"},"/assets/js/index.js"),", which communicates with the contract through a ",(0,l.kt)("inlineCode",{parentName:"p"},"wallet"),". You will notice in ",(0,l.kt)("inlineCode",{parentName:"p"},"/assets/js/index.js")," the following code:"),(0,l.kt)(s.O2,{mdxType:"CodeTabs"},(0,l.kt)(s.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,l.kt)(s.Ey,{fname:"index.js",url:"https://github.com/near-examples/coin-flip-workshop-js/blob/main/frontend/index.js",start:"10",end:"19",mdxType:"Github"}))),(0,l.kt)("p",null,"It indicates our app, when it starts, to check if the user is already logged in and execute either ",(0,l.kt)("inlineCode",{parentName:"p"},"signedInFlow()")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"signedOutFlow()"),"."),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"testing"},"Testing"),(0,l.kt)("p",null,"When writing smart contracts, it is very important to test all methods exhaustively. In this\nproject, you have two types: unit and integration tests. Before digging into them,\ngo ahead and perform the tests present in the dApp through the command ",(0,l.kt)("inlineCode",{parentName:"p"},"yarn test"),"."),(0,l.kt)("h3",{id:"integration-test"},"Integration test"),(0,l.kt)("p",null,"Integration tests are generally written in JavaScript. They automatically deploy a new\ncontract and execute methods on it. In this way, integration tests simulate interactions\nfrom users in a realistic scenario. You will find the integration tests for the ",(0,l.kt)("inlineCode",{parentName:"p"},"counter"),"\nin ",(0,l.kt)("inlineCode",{parentName:"p"},"tests/integration-tests"),"."),(0,l.kt)(s.O2,{mdxType:"CodeTabs"},(0,l.kt)(s.SQ,{value:"\ud83c\udf10 JavaScript",language:"ts",mdxType:"Language"},(0,l.kt)(s.Ey,{fname:"main.test.js",url:"https://github.com/near-examples/coin-flip-workshop-js/blob/main/integration-tests/src/main.ava.ts",start:"32",end:"56",mdxType:"Github"}))),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"a-note-on-randomness"},"A Note On Randomness"),(0,l.kt)("p",null,"Randomness in the blockchain is a complex subject. We recommend you to read and investigate about it.\nYou can start with our ",(0,l.kt)("a",{parentName:"p",href:"/develop/contracts/security/random"},"security page on it"),"."))}f.isMDXComponent=!0},79199:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/coin-flip-54eec9769bd7c2c68778790d69fcd4ab.png"}}]);