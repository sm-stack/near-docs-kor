"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6812],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=c(t),m=i,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return t?a.createElement(h,s(s({ref:n},p),{},{components:t})):a.createElement(h,s({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,s=new Array(r);s[0]=u;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,s[1]=o;for(var c=2;c<r;c++)s[c]=t[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},89178:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var a=t(87462),i=t(63366),r=(t(67294),t(3905)),s=["components"],o={id:"fungible-tokens",title:"Fungible tokens",sidebar_label:"Fungible Tokens"},l=void 0,c={unversionedId:"integrator/fungible-tokens",id:"integrator/fungible-tokens",title:"Fungible tokens",description:"Introduction",source:"@site/../docs/6.integrator/tokens.md",sourceDirName:"6.integrator",slug:"/integrator/fungible-tokens",permalink:"/near-docs-kor/integrator/fungible-tokens",draft:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/6.integrator/tokens.md",tags:[],version:"current",lastUpdatedBy:"[sm-stack]",lastUpdatedAt:1675844989,formattedLastUpdatedAt:"Feb 8, 2023",frontMatter:{id:"fungible-tokens",title:"Fungible tokens",sidebar_label:"Fungible Tokens"},sidebar:"integrate",previous:{title:"Create a Transaction",permalink:"/near-docs-kor/integrator/create-transactions"},next:{title:"Implicit Accounts",permalink:"/near-docs-kor/integrator/implicit-accounts"}},p={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Get balance",id:"get-balance",level:2},{value:"Get info about the FT",id:"get-info-about-the-ft",level:2},{value:"Simple transfer",id:"simple-transfer",level:2},{value:"Transfer and call",id:"transfer-and-call",level:2},{value:"Successful transfer and call",id:"successful-transfer-and-call",level:3},{value:"Failed transfer and call",id:"failed-transfer-and-call",level:3}],u={toc:d};function m(e){var n=e.components,t=(0,i.Z)(e,s);return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Please see the ",(0,r.kt)("a",{parentName:"p",href:"https://nomicon.io/Standards/FungibleToken/"},"spec for the fungible token standard")," and an ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/near-examples/FT"},"example implementation")," for reference details."),(0,r.kt)("p",null,"One notable aspect of the standard is that method names are prefixed with ",(0,r.kt)("inlineCode",{parentName:"p"},"ft_"),". This will be a helpful convention when querying for transactions related to fungible tokens."),(0,r.kt)("h2",{id:"get-balance"},"Get balance"),(0,r.kt)("p",null,"Using the abstraction of the ",(0,r.kt)("a",{parentName:"p",href:"/tools/near-cli"},"NEAR CLI")," tool, we can check the balance of a user's account with ",(0,r.kt)("a",{parentName:"p",href:"/tools/near-cli#near-view"},(0,r.kt)("inlineCode",{parentName:"a"},"near view")),":"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},'near view ft.demo.testnet ft_balance_of \'{"account_id": "mike.testnet"}\'')),(0,r.kt)("p",null,"Returns:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'View call: ft.demo.testnet.ft_balance_of({"account_id": "mike.testnet"})\n\'1000000\'\n')),(0,r.kt)("p",null,"Alternatively, you can ",(0,r.kt)("a",{parentName:"p",href:"/api/rpc/setup#call-a-contract-function"},"call a contract function")," using the ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," RPC endpoint. Below is an example using HTTPie:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://rpc.testnet.near.org jsonrpc=2.0 id=ftbalance method=query \\\nparams:=\'{\n  "request_type": "call_function",\n  "finality": "final",\n  "account_id": "ft.demo.testnet",\n  "method_name": "ft_balance_of",\n  "args_base64": "eyJhY2NvdW50X2lkIjogIm1pa2UudGVzdG5ldCJ9"\n}\'\n')),(0,r.kt)("p",null,"Returns:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'HTTP/1.1 200 OK\nAlt-Svc: clear\nVia: 1.1 google\naccess-control-allow-origin:\ncontent-length: 176\ncontent-type: application/json\ndate: Thu, 27 May 2021 12:53:38 GMT\n\n{\n    "id": "dontcare",\n    "jsonrpc": "2.0",\n    "result": {\n        "block_hash": "3mvNHpZAsXiJ6SuHU1mbLVB4iXCfh5i5d41pnkaSoaJ5",\n        "block_height": 49282350,\n        "logs": [],\n        "result": [ 34, 49, 48, 48, 48, 48, 48, 48, 34 ]\n    }\n}\n')),(0,r.kt)("p",null,"As mentioned earlier, the ",(0,r.kt)("inlineCode",{parentName:"p"},"result")," is an array of bytes. There are various ways to convert bytes into a more human-readable form such as the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/guoxbin/dtool#installation"},"dtool CLI"),"."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"dtool a2h '[34,49,48,48,48,48,48,48,34]' | dtool h2s")),(0,r.kt)("p",null,"Returns:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},'"1000000"')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," The fungible token balance of the account ",(0,r.kt)("inlineCode",{parentName:"p"},"mike.testnet")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"1000000"),' wrapped in double-quotes. This is because of an issue with JSON serialization. Amounts given in arguments and results must be serialized as Base-10 strings, e.g. "100". This is done to avoid JSON limitation of max integer value of 2**53, which can certainly happen with fungible tokens.'),(0,r.kt)("h2",{id:"get-info-about-the-ft"},"Get info about the FT"),(0,r.kt)("p",null,"You can get ",(0,r.kt)("inlineCode",{parentName:"p"},"name"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"decimals"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"icon")," and other parameters by calling the next function:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"near view <contract_account_id> ft_metadata\n")),(0,r.kt)("p",{parentName:"li"},"Result:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"View call: ft.demo.testnet.ft_metadata()\n{\n  spec: 'ft-1.0.0',\n  name: 'Example Token Name',\n  symbol: 'MOCHI',\n  icon: null,\n  reference: null,\n  reference_hash: null,\n  decimals: 24\n}\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://rpc.testnet.near.org jsonrpc=2.0 id=ftmetadata method=query \\\nparams:=\'{\n  "request_type": "call_function",\n  "finality": "final",\n  "account_id": "<contract_account_id>",\n  "method_name": "ft_metadata",\n  "args_base64": ""\n}\'\n')),(0,r.kt)("p",{parentName:"li"},"  Example response:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'HTTP/1.1 200 OK\nAlt-Svc: clear\nVia: 1.1 google\naccess-control-allow-origin:\ncontent-length: 604\ncontent-type: application/json\ndate: Wed, 02 Jun 2021 15:51:17 GMT\n\n{\n    "id": "ftmetadata",\n    "jsonrpc": "2.0",\n    "result": {\n        "block_hash": "B3fu3v4dmn19B6oqjHUXN3k5NhdP9EW5kkjyuFUDpa1r",\n        "block_height": 50061565,\n        "logs": [],\n        "result": [ 123, 34, 115, 112, 101, 99, 34, 58, 34, 102, 116, 45, 49, 46, 48, 46, 48, 34, 44, 34, 110, 97, 109, 101, 34, 58, 34, 69, 120, 97, 109, 112, 108, 101, 32, 84, 111, 107, 101, 110, 32, 78, 97, 109, 101, 34, 44, 34, 115, 121, 109, 98, 111, 108, 34, 58, 34, 77, 79, 67, 72, 73, 34, 44, 34, 105, 99, 111, 110, 34, 58, 110, 117, 108, 108, 44, 34, 114, 101, 102, 101, 114, 101, 110, 99, 101, 34, 58, 110, 117, 108, 108, 44, 34, 114, 101, 102, 101, 114, 101, 110, 99, 101, 95, 104, 97, 115, 104, 34, 58, 110, 117, 108, 108, 44, 34, 100, 101, 99, 105, 109, 97, 108, 115, 34, 58, 50, 52, 125 ]\n    }\n}\n')),(0,r.kt)("p",{parentName:"li"},"  Decoded result in this case is:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "spec": "ft-1.0.0",\n  "name": "Example Token Name",\n  "symbol": "MOCHI",\n  "icon": null,\n  "reference": null,\n  "reference_hash": null,\n  "decimals": 24\n}\n')))),(0,r.kt)("h2",{id:"simple-transfer"},"Simple transfer"),(0,r.kt)("p",null,"To follow this guide, please check the ",(0,r.kt)("a",{parentName:"p",href:"/integrator/create-transactions#low-level----create-a-transaction"},"step by step instructions")," on how to create a transaction first."),(0,r.kt)("p",null,"In order to send a fungible token to an account, the receiver must have a storage deposit. This is because each smart contract on NEAR must account for storage used, and each account on a fungible token contract is a key-value pair, taking up a small amount of storage. For more information, please see ",(0,r.kt)("a",{parentName:"p",href:"/concepts/storage/storage-staking"},"how storage works in NEAR"),". To check if account has deposited the storage for this FT do the following:"),(0,r.kt)("p",null,"Get storage balance of the account. ",(0,r.kt)("inlineCode",{parentName:"p"},"storage_balance_of")," function returns the amount of deposited storage or ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," if there is no deposit."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'near view <contract_account_id> storage_balance_of \'{"account_id": "<user_account_id>"}\'\n')),(0,r.kt)("p",{parentName:"li"},"Result:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'View call: ft.demo.testnet.storage_balance_of({"account_id": "serhii.testnet"})\nnull\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://rpc.testnet.near.org jsonrpc=2.0 id=storagebalanceof method=query \\\nparams:=\'{\n   "request_type": "call_function",\n   "finality": "final",\n   "account_id": "ft.demo.testnet",\n   "method_name": "storage_balance_of",\n   "args_base64": "eyJhY2NvdW50X2lkIjogInNlcmhpaS50ZXN0bmV0In0K"\n}\'\n')),(0,r.kt)("p",{parentName:"li"},"  Example response:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'HTTP/1.1 200 OK\nAlt-Svc: clear\nVia: 1.1 google\naccess-control-allow-origin:\ncontent-length: 173\ncontent-type: application/json\ndate: Wed, 02 Jun 2021 14:22:01 GMT\n{\n    "id": "storagebalanceof",\n    "jsonrpc": "2.0",\n    "result": {\n        "block_hash": "EkM2j4yxRVoQ1TCqF2KUb7J4w5G1VsWtMLiycq6k3f53",\n        "block_height": 50054247,\n        "logs": [],\n        "result": [ 110, 117, 108, 108 ]\n    }\n}\n')),(0,r.kt)("p",{parentName:"li"},"  Decoded result in this case is ",(0,r.kt)("inlineCode",{parentName:"p"},"null"),"."))),(0,r.kt)("p",null,"Get the minimum storage required for FT. (The storage used for an account's key-value pair.)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"near view <contract_account_id> storage_balance_bounds`\n")),(0,r.kt)("p",{parentName:"li"},"Result:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"View call: ft.demo.testnet.storage_balance_bounds()\n{ min: '1250000000000000000000', max: '1250000000000000000000' }\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://rpc.testnet.near.org jsonrpc=2.0 id=storagebalancebounds method=query \\\nparams:=\'{\n    "request_type": "call_function",\n    "finality": "final",\n    "account_id": "<contract_account_id>",\n    "method_name": "storage_balance_bounds",\n    "args_base64": ""\n}\'\n')),(0,r.kt)("p",{parentName:"li"},"  Example response:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'HTTP/1.1 200 OK\nAlt-Svc: clear\nVia: 1.1 google\naccess-control-allow-origin:\ncontent-length: 357\ncontent-type: application/json\ndate: Wed, 02 Jun 2021 15:42:49 GMT\n\n{\n    "id": "storagebalancebounds",\n    "jsonrpc": "2.0",\n    "result": {\n        "block_hash": "Fy3mBqwj5nvUDha3X7G61kmUeituHASEX12oCASrChEE",\n        "block_height": 50060878,\n        "logs": [],\n        "result": [ 123, 34, 109, 105, 110, 34, 58, 34, 49, 50, 53, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 34, 44, 34, 109, 97, 120, 34, 58, 34, 49, 50, 53, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 34, 125 ]\n    }\n}\n')),(0,r.kt)("p",{parentName:"li"},"  Decoded result should look similar to:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "min": "1250000000000000000000",\n  "max": "1250000000000000000000"\n}\n')))),(0,r.kt)("p",null,"Basic fungible tokens are simple smart contracts that don't have variable storage as compared to a smart contract that might store free-form text, for instance. The only storage needed is for an accounts key-value pair, which will always be covered by the ",(0,r.kt)("inlineCode",{parentName:"p"},"1250000000000000000000")," yocto\u24c3 storage balance."),(0,r.kt)("p",null,"If there is not enough deposit for the storage or returned value is ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," - you should deposit more storage with the next command:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI, don't forget to convert from yocto\u24c3 to \u24c3:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'near call <contract_account_id> storage_deposit \'{"account_id": "<user_account_id>"}\' --accountId <sender_account_id> --deposit <deposit in \u24c3>\n')),(0,r.kt)("p",{parentName:"li"},"Result example:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"Scheduling a call: ft.demo.testnet.storage_deposit() with attached 0.125 NEAR\nTransaction Id 9CMrMMt3UzeU63FFrUyFb1gNGuHXxvKfHqYJzyFTAk6z\nTo see the transaction in the transaction explorer, please open this url in your browser\nhttps://explorer.testnet.near.org/transactions/9CMrMMt3UzeU63FFrUyFb1gNGuHXxvKfHqYJzyFTAk6z\n{ total: '1250000000000000000000', available: '0' }\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call:"),(0,r.kt)("p",{parentName:"li"},"At the top of this section is a link detailing how to ",(0,r.kt)("a",{parentName:"p",href:"/integrator/create-transactions#low-level----create-a-transaction"},"construct a transaction")," without the full abstraction of the ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/near-api-js"},(0,r.kt)("inlineCode",{parentName:"a"},"near-api-js")," library"),". For this and future examples that use the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.near.org/api/rpc/setup#send-transaction-await"},"RPC method ",(0,r.kt)("inlineCode",{parentName:"a"},"broadcast_tx_commit"))," we will provide a JSON-like object meant to act similar to ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Pseudocode"},"pseudocode"),", only imparting high-level details of a transaction. This code block below is the first example of this, detailing what goes into the transaction discussed currently, involving the method ",(0,r.kt)("inlineCode",{parentName:"p"},"storage_deposit"),"."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'Transaction: {\n    block_hash: `456\u2026abc`,\n    signer_id: "serhii.testnet",\n    public_key: "ed25519:789\u2026def",\n    nonce: 123,\n    receiver_id: "ft.demo.testnet",\n    actions: [\n        FunctionCall(\n            FunctionCallAction {\n                method_name: storage_deposit,\n                args: `{"account_id": "robertyan.near"}`,\n                gas: 300000000000000,\n                deposit: 1250000000000000000000,\n            },\n        ),\n    ]\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  ```bash\n  http post https://rpc.testnet.near.org jsonrpc=2.0 id=dontcare method=broadcast_tx_commit \\\n      params:='[\"DgAAAHNlcmhpaS50ZXN0bmV0AEKEp54fyVkp8dJE2l/m1ErjdhDGodBK8ZF6JLeHFMeZi/qoVEgrAAAPAAAAZnQuZGVtby50ZXN0bmV0JYbWPOu0P9T32vtUKnZSh+EaoboQqg0/De2i8Y+AjHIBAAAAAg8AAABzdG9yYWdlX2RlcG9zaXQCAAAAe30AQHoQ81oAAAAAILSd2XlDeBoAAAAAAAAAZF7+s4lcHOzy+re59VErt7LcZkPMMUVgOJV8LH5TsLBBv+8h/5tZ6+HFwxSp605A4c46oS9Jw4KBRXZD07lKCg==\"]'\n  ```\n")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"**Example Response:**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "myid",\n  "jsonrpc": "2.0",\n  "result": {\n    "receipts": [\n      {\n        "predecessor_id": "serhii.testnet",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "e30=",\n                  "deposit": "125000000000000000000000",\n                  "gas": 100000000000000,\n                  "method_name": "storage_deposit"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "4urgFabknn1myZkjTYdb1BFSoEimP21k9smCUWoSggA7",\n        "receiver_id": "ft.demo.testnet"\n      },\n      {\n        "predecessor_id": "ft.demo.testnet",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "123750000000000000000000"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "7neJYE45vXnQia1LQqWuAfyTRXHy4vv88JaULa5DnNBd",\n        "receiver_id": "serhii.testnet"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "19200274886926125000"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "2c59u2zYj41JuhMfPUCKjNucmYfz2Jt83JLWP6VyQn1S",\n        "receiver_id": "serhii.testnet"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "18587201427159524319124"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "kaYatRKxcC1NXac69WwTqg6K13oXq2yEuy4LLZtsV2G",\n        "receiver_id": "serhii.testnet"\n      }\n    ],\n    "receipts_outcome": [\n      {\n        "block_hash": "6Gz6P8N3F447kRc7kkxEhuZRZTzfuTUEagye65bPVGb",\n        "id": "4urgFabknn1myZkjTYdb1BFSoEimP21k9smCUWoSggA7",\n        "outcome": {\n          "executor_id": "ft.demo.testnet",\n          "gas_burnt": 4258977405434,\n          "logs": [],\n          "receipt_ids": [\n            "7neJYE45vXnQia1LQqWuAfyTRXHy4vv88JaULa5DnNBd",\n            "kaYatRKxcC1NXac69WwTqg6K13oXq2yEuy4LLZtsV2G"\n          ],\n          "status": {\n            "SuccessValue": "eyJ0b3RhbCI6IjEyNTAwMDAwMDAwMDAwMDAwMDAwMDAiLCJhdmFpbGFibGUiOiIwIn0="\n          },\n          "tokens_burnt": "425897740543400000000"\n        },\n        "proof": []\n      },\n      {\n        "block_hash": "J6YXMnLPfLEPyvL3fWdhWPzpWAeW8zNY2CwAFwAg9tfr",\n        "id": "7neJYE45vXnQia1LQqWuAfyTRXHy4vv88JaULa5DnNBd",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 223182562500,\n          "logs": [],\n          "receipt_ids": [\n            "2c59u2zYj41JuhMfPUCKjNucmYfz2Jt83JLWP6VyQn1S"\n          ],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "22318256250000000000"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "D6tGfHwKh21PqzhBTsdKCsTtZvXFDkmH39dQiQBoGN3w"\n          }\n        ]\n      },\n      {\n        "block_hash": "HRRF7N1PphZ46eN5g4DjqEgYHBYM76yGiXSTYWsfMGoy",\n        "id": "2c59u2zYj41JuhMfPUCKjNucmYfz2Jt83JLWP6VyQn1S",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": []\n      },\n      {\n        "block_hash": "J6YXMnLPfLEPyvL3fWdhWPzpWAeW8zNY2CwAFwAg9tfr",\n        "id": "kaYatRKxcC1NXac69WwTqg6K13oXq2yEuy4LLZtsV2G",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Left",\n            "hash": "1uVJZ8vNQpHMwPA38DYJjk9PpvnHDhsDcMxrTXcwf1s"\n          }\n        ]\n      }\n    ],\n    "status": {\n      "SuccessValue": "eyJ0b3RhbCI6IjEyNTAwMDAwMDAwMDAwMDAwMDAwMDAiLCJhdmFpbGFibGUiOiIwIn0="\n    },\n    "transaction": {\n      "actions": [\n        {\n          "FunctionCall": {\n            "args": "e30=",\n            "deposit": "125000000000000000000000",\n            "gas": 100000000000000,\n            "method_name": "storage_deposit"\n          }\n        }\n      ],\n      "hash": "6sDUF1f5hebpybUbipNJer5ez13EY4HW1VBJEBqZjCEm",\n      "nonce": 47589658000011,\n      "public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN",\n      "receiver_id": "ft.demo.testnet",\n      "signature": "ed25519:31PfuinsVvM1o2CmiZbSguFkZKYqAtkf5PHerfexhDbC3SsJWDzRFBpoUYTNDJddhKeqs93GQ3SHtUyqaSYhhQ9X",\n      "signer_id": "serhii.testnet"\n    },\n    "transaction_outcome": {\n      "block_hash": "5XiuxzTpyw6p2NTD5AqrZYNW7SHvpj8MhUCyn1x2KSQR",\n      "id": "6sDUF1f5hebpybUbipNJer5ez13EY4HW1VBJEBqZjCEm",\n      "outcome": {\n        "executor_id": "serhii.testnet",\n        "gas_burnt": 2427959010878,\n        "logs": [],\n        "receipt_ids": [\n          "4urgFabknn1myZkjTYdb1BFSoEimP21k9smCUWoSggA7"\n        ],\n        "status": {\n          "SuccessReceiptId": "4urgFabknn1myZkjTYdb1BFSoEimP21k9smCUWoSggA7"\n        },\n        "tokens_burnt": "242795901087800000000"\n      },\n      "proof": []\n    }\n  }\n}\n'))),(0,r.kt)("p",null,"Transfer the tokens:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'near call <contract_account_id> ft_transfer \'{"receiver_id": "<receiver_account_id>", "amount": "1"}\' --accountId <sender_account_id> --amount 0.000000000000000000000001\n')),(0,r.kt)("p",{parentName:"li"},"Result example:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'Scheduling a call: berryclub.ek.near.ft_transfer({"receiver_id": "volovyk.near", "amount": "1"}) with attached 0.000000000000000000000001 NEAR\nReceipt: GDeE3Kv1JHgs71A22NEUbgq55r2Hvcnis8gCMyJtQ2mx\n    Log [berryclub.ek.near]: Transfer 1 from serhii.near to volovyk.near\nTransaction Id 3MkWKbXVP8wyy4pBofELqiE1pwx7ie2v3SKCwaobNcEe\nTo see the transaction in the transaction explorer, please open this url in your browser\nhttps://explorer.mainnet.near.org/transactions/3MkWKbXVP8wyy4pBofELqiE1pwx7ie2v3SKCwaobNcEe\n\'\'\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call:"))),(0,r.kt)("p",null,"Transaction representation:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'Transaction: {\n    block_hash: `456\u2026abc`,\n    signer_id: "serhii.near",\n    public_key: "ed25519:789\u2026def",\n    nonce: 123,\n    receiver_id: "berryclub.ek.near",\n    actions: [\n        FunctionCall(\n            FunctionCallAction {\n                method_name: ft_transfer,\n                args: `{"receiver_id": "volovyk.near", "amount": "1"}`,\n                gas: 300000000000000,\n                deposit: 1,\n            },\n        ),\n    ]\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  ```bash\n  http post https://rpc.testnet.near.org jsonrpc=2.0 id=dontcare method=broadcast_tx_commit \\\n      params:='[\"CwAAAHNlcmhpaS5uZWFyAAmQpgZcJM5nMc6f3tqmw/YI4eAvc84ZgsKMRRRzhY/6CQAAAAAAAAARAAAAYmVycnljbHViLmVrLm5lYXLLWPIiUOElkDF3u4hLAMJ0Sjeo1V338pDdHIp70va3ewEAAAACCwAAAGZ0X3RyYW5zZmVyKwAAAHsicmVjZWl2ZXJfaWQiOiJ2b2xvdnlrLm5lYXIiLCJhbW91bnQiOiIxIn0AQHoQ81oAAAEAAAAAAAAAAAAAAAAAAAAA7fDOZQt3zCtdS05Y8XaZFlwO/Gd5wkkNAHShzDiLQXk4Q4ixpraLPMJivs35PZD0gocXl1iGFbQ46NG3VllzCA==\"]'\n  ```\n")),(0,r.kt)("p",null,"To get details of this transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://archival-rpc.mainnet.near.org jsonrpc=2.0 method=EXPERIMENTAL_tx_status \\\n  params:=\'["2Fy4714idMCoja7QLdGAbQZHzV2XEnUdwZX6yGa46VMX", "serhii.near"]\' id=myid\n')),(0,r.kt)("details",null,(0,r.kt)("summary",null,"**Example Response:**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "myid",\n  "jsonrpc": "2.0",\n  "result": {\n    "receipts": [\n      {\n        "predecessor_id": "serhii.near",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "eyJyZWNlaXZlcl9pZCI6InZvbG92eWsubmVhciIsImFtb3VudCI6IjEifQ==",\n                  "deposit": "1",\n                  "gas": 100000000000000,\n                  "method_name": "ft_transfer"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.near",\n            "signer_public_key": "ed25519:eLbduR3uJGaAHLXeGKEfo1fYmYFKkLyR1R8ZPCxrJAM"\n          }\n        },\n        "receipt_id": "ExhYcvwAUb3Jpm38pSQ5oobwJAouBqqDZjbhavKrZtur",\n        "receiver_id": "berryclub.ek.near"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "18418055677558685763688"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.near",\n            "signer_public_key": "ed25519:eLbduR3uJGaAHLXeGKEfo1fYmYFKkLyR1R8ZPCxrJAM"\n          }\n        },\n        "receipt_id": "EAPh8XrBMqm6iuVH5jsfemz4YqUxWsV8Mz241cw5tjvE",\n        "receiver_id": "serhii.near"\n      }\n    ],\n    "receipts_outcome": [\n      {\n        "block_hash": "6Re4NTkKzD7maKx3MuoxzYVHQKqjgnXW8rNjGjeVx8YC",\n        "id": "ExhYcvwAUb3Jpm38pSQ5oobwJAouBqqDZjbhavKrZtur",\n        "outcome": {\n          "executor_id": "berryclub.ek.near",\n          "gas_burnt": 6365774114160,\n          "logs": [\n            "Transfer 1 from serhii.near to volovyk.near"\n          ],\n          "receipt_ids": [\n            "EAPh8XrBMqm6iuVH5jsfemz4YqUxWsV8Mz241cw5tjvE"\n          ],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "636577411416000000000"\n        },\n        "proof": [\n          {\n            "direction": "Left",\n            "hash": "2eUmWnLExsH5jb6mALY9jTC8FiQH4FcuxQ16tn7RfkYr"\n          },\n          {\n            "direction": "Right",\n            "hash": "266d5QfDKXNbAWJgXMJXgLP97VwoMiC4Qyt8wH7xcs1Q"\n          },\n          {\n            "direction": "Right",\n            "hash": "EkJAuJigdVSZj41yGXSZYAtDV7Xwe2Hv9Xsqcv6LUZvq"\n          }\n        ]\n      },\n      {\n        "block_hash": "3XMoeEdm1zE64aByFuWCrZaxfbvsjMHRFcL8Wsp95vyt",\n        "id": "EAPh8XrBMqm6iuVH5jsfemz4YqUxWsV8Mz241cw5tjvE",\n        "outcome": {\n          "executor_id": "serhii.near",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "EGC9ZPJHTbmCs3aQDuCkFQboGLBxU2uzrSZMsp8WonDu"\n          },\n          {\n            "direction": "Right",\n            "hash": "EsBd1n7bDAphA3HY84DrrKd1GP1VugeNiqFCET2S5sNG"\n          },\n          {\n            "direction": "Left",\n            "hash": "H4q3ByfNB7QH9QEuHN3tcGay7tjhsZwjXx3sq3Vm3Lza"\n          }\n        ]\n      }\n    ],\n    "status": {\n      "SuccessValue": ""\n    },\n    "transaction": {\n      "actions": [\n        {\n          "FunctionCall": {\n            "args": "eyJyZWNlaXZlcl9pZCI6InZvbG92eWsubmVhciIsImFtb3VudCI6IjEifQ==",\n            "deposit": "1",\n            "gas": 100000000000000,\n            "method_name": "ft_transfer"\n          }\n        }\n      ],\n      "hash": "2Fy4714idMCoja7QLdGAbQZHzV2XEnUdwZX6yGa46VMX",\n      "nonce": 10,\n      "public_key": "ed25519:eLbduR3uJGaAHLXeGKEfo1fYmYFKkLyR1R8ZPCxrJAM",\n      "receiver_id": "berryclub.ek.near",\n      "signature": "ed25519:5eJPGirNkBUbMeyRfEA4fgi1FtkgGk8pmbbkmiz3Faf6zrANpBsCs5bZd5heSTvQ6b3fEPLSPCPi2iwD2XJT93As",\n      "signer_id": "serhii.near"\n    },\n    "transaction_outcome": {\n      "block_hash": "EAcwavyaeNWZnfhYP2nAWzeDgMiuiyRHfaprFqhXgCRF",\n      "id": "2Fy4714idMCoja7QLdGAbQZHzV2XEnUdwZX6yGa46VMX",\n      "outcome": {\n        "executor_id": "serhii.near",\n        "gas_burnt": 2428041740436,\n        "logs": [],\n        "receipt_ids": [\n          "ExhYcvwAUb3Jpm38pSQ5oobwJAouBqqDZjbhavKrZtur"\n        ],\n        "status": {\n          "SuccessReceiptId": "ExhYcvwAUb3Jpm38pSQ5oobwJAouBqqDZjbhavKrZtur"\n        },\n        "tokens_burnt": "242804174043600000000"\n      },\n      "proof": [\n        {\n          "direction": "Right",\n          "hash": "GatQmy7fW5uXRJRSg7A315CWzWWcQCGk4GJXyW3cjw4j"\n        },\n        {\n          "direction": "Right",\n          "hash": "89WJwAetivZLvAkVLXUt862o7zJX7YYt6ZixdWebq3xv"\n        },\n        {\n          "direction": "Right",\n          "hash": "CH3wHSqYPJp35krLjSgJTgCFYnv1ymhd9bJpjXA31VVD"\n        }\n      ]\n    }\n  }\n}\n'))),(0,r.kt)("p",null,"You can get the same info later by the transaction hash from the previous call:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"using NEAR Explorer: ",(0,r.kt)("a",{parentName:"li",href:"https://explorer.near.org"},"https://explorer.near.org"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'    http post https://rpc.testnet.near.org jsonrpc=2.0 id=dontcare method=EXPERIMENTAL_tx_status \\\n    params:=\'[ "2Fy4714idMCoja7QLdGAbQZHzV2XEnUdwZX6yGa46VMX", "sender.testnet"]\'\n')))),(0,r.kt)("p",null,"Let's create test transaction that should fail and investigate the response. We will try to send more tokens that are available on this account:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'near call <contract_account_id> ft_transfer \'{"receiver_id": "<user_account_id>", "amount": "10000000000"}\' --accountId <sender_account_id> --amount 0.000000000000000000000001\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call:"))),(0,r.kt)("p",null,"Transaction representation:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'Transaction: {\n    block_hash: `456\u2026abc`,\n    signer_id: "serhii.near",\n    public_key: "ed25519:789\u2026def",\n    nonce: 123,\n    receiver_id: "berryclub.ek.near",\n    actions: [\n        FunctionCall(\n            FunctionCallAction {\n                method_name: ft_transfer,\n                args: `{"receiver_id":"volovyk.near","amount":"10000000000000000000"}`,\n                gas: 300000000000000,\n                deposit: 1,\n            },\n        ),\n    ]\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```bash\n  http post https://rpc.testnet.near.org jsonrpc=2.0 id=dontcare method=broadcast_tx_commit \\\n  params:='[\"DgAAAHNlcmhpaS50ZXN0bmV0AEKEp54fyVkp8dJE2l/m1ErjdhDGodBK8ZF6JLeHFMeZofqoVEgrAAAgAAAAZGV2LTE2MjMzMzM3OTU2MjMtMjEzOTk5NTk3NzgxNTm8Xq8BTIi6utG0424Gg7CknYzLH8RH/A409jq5o0zi7gEAAAACCwAAAGZ0X3RyYW5zZmVyPwAAAHsicmVjZWl2ZXJfaWQiOiJkZXYtMTYyMzMzMzkxNjM2OC01ODcwNzQzNDg3ODUzMyIsImFtb3VudCI6IjEifQBAehDzWgAAAQAAAAAAAAAAAAAAAAAAAABCwjqayKdpWgM6PE0ixzm/Gy0EtdpxVn0xehMTBReVfVAKIBTDPoPSaOdT8fAhk343F5uOMfSijhTqU2mWV3oD\"]'\n```\n")),(0,r.kt)("p",null,"To get details of this transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://archival-rpc.mainnet.near.org jsonrpc=2.0 method=EXPERIMENTAL_tx_status \\\n  params:=\'["CKHzodHvFw4C87PazsniycYZZHm37CEWLE2u8VUUMU7r", "serhii.near"]\' id=myid\n')),(0,r.kt)("details",null,(0,r.kt)("summary",null,"**Example Response:**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "myid",\n  "jsonrpc": "2.0",\n  "result": {\n    "receipts": [\n      {\n        "predecessor_id": "serhii.near",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "eyJyZWNlaXZlcl9pZCI6InZvbG92eWsubmVhciIsImFtb3VudCI6IjEwMDAwMDAwMDAwMDAwMDAwMDAwIn0=",\n                  "deposit": "1",\n                  "gas": 100000000000000,\n                  "method_name": "ft_transfer"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.near",\n            "signer_public_key": "ed25519:eLbduR3uJGaAHLXeGKEfo1fYmYFKkLyR1R8ZPCxrJAM"\n          }\n        },\n        "receipt_id": "5bdBKwS1RH7wm8eoG6ZeESdhNpj9HffUcf8RoP6Ng5d",\n        "receiver_id": "berryclub.ek.near"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "1"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "system",\n            "signer_public_key": "ed25519:11111111111111111111111111111111"\n          }\n        },\n        "receipt_id": "Td3QxpKhMdi8bfVeMiQZwNS1VzPXceQdn6xdftoC8k6",\n        "receiver_id": "serhii.near"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "18653463364152698495356"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.near",\n            "signer_public_key": "ed25519:eLbduR3uJGaAHLXeGKEfo1fYmYFKkLyR1R8ZPCxrJAM"\n          }\n        },\n        "receipt_id": "DwLMVTdqv9Z4g9QC4AthTXHqqeJVAH4s1tFXHQYMArW7",\n        "receiver_id": "serhii.near"\n      }\n    ],\n    "receipts_outcome": [\n      {\n        "block_hash": "DTruWLgm5Y56yDrxUipvYqKKm8F7hxVQTarNQqe147zs",\n        "id": "5bdBKwS1RH7wm8eoG6ZeESdhNpj9HffUcf8RoP6Ng5d",\n        "outcome": {\n          "executor_id": "berryclub.ek.near",\n          "gas_burnt": 4011776278642,\n          "logs": [],\n          "receipt_ids": [\n            "Td3QxpKhMdi8bfVeMiQZwNS1VzPXceQdn6xdftoC8k6",\n            "DwLMVTdqv9Z4g9QC4AthTXHqqeJVAH4s1tFXHQYMArW7"\n          ],\n          "status": {\n            "Failure": {\n              "ActionError": {\n                "index": 0,\n                "kind": {\n                  "FunctionCallError": {\n                    "ExecutionError": "Smart contract panicked: The account doesn\'t have enough balance"\n                  }\n                }\n              }\n            }\n          },\n          "tokens_burnt": "401177627864200000000"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "6GHrA42oMEF4g7YCBpPw9EakkLiepTHnQBvaKtmsenEY"\n          },\n          {\n            "direction": "Right",\n            "hash": "DCG3qZAzf415twXfHmgBUdB129g2iZoQ4v8dawwBzhSh"\n          }\n        ]\n      },\n      {\n        "block_hash": "F9xNWGhJuYW336f3qVaDDAipsyfpudJHYbmt5in3MeMT",\n        "id": "Td3QxpKhMdi8bfVeMiQZwNS1VzPXceQdn6xdftoC8k6",\n        "outcome": {\n          "executor_id": "serhii.near",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "CJNvis1CoJmccshDpPBrk3a7fdZ5HnMQuy3p2Kd2GCdS"\n          },\n          {\n            "direction": "Left",\n            "hash": "4vHM3fbdNwXGMp9uYzVKB13abEM6qdPUuZ9rfrdsaDzc"\n          }\n        ]\n      },\n      {\n        "block_hash": "F9xNWGhJuYW336f3qVaDDAipsyfpudJHYbmt5in3MeMT",\n        "id": "DwLMVTdqv9Z4g9QC4AthTXHqqeJVAH4s1tFXHQYMArW7",\n        "outcome": {\n          "executor_id": "serhii.near",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Left",\n            "hash": "BR3R7tjziEgXMiHaJ7VuuXCo2yBHB2ZzsoxobPhPjFeJ"\n          },\n          {\n            "direction": "Left",\n            "hash": "4vHM3fbdNwXGMp9uYzVKB13abEM6qdPUuZ9rfrdsaDzc"\n          }\n        ]\n      }\n    ],\n    "status": {\n      "Failure": {\n        "ActionError": {\n          "index": 0,\n          "kind": {\n            "FunctionCallError": {\n              "ExecutionError": "Smart contract panicked: The account doesn\'t have enough balance"\n            }\n          }\n        }\n      }\n    },\n    "transaction": {\n      "actions": [\n        {\n          "FunctionCall": {\n            "args": "eyJyZWNlaXZlcl9pZCI6InZvbG92eWsubmVhciIsImFtb3VudCI6IjEwMDAwMDAwMDAwMDAwMDAwMDAwIn0=",\n            "deposit": "1",\n            "gas": 100000000000000,\n            "method_name": "ft_transfer"\n          }\n        }\n      ],\n      "hash": "CKHzodHvFw4C87PazsniycYZZHm37CEWLE2u8VUUMU7r",\n      "nonce": 12,\n      "public_key": "ed25519:eLbduR3uJGaAHLXeGKEfo1fYmYFKkLyR1R8ZPCxrJAM",\n      "receiver_id": "berryclub.ek.near",\n      "signature": "ed25519:63MC3f8m5jeycpy97G9XaCwmJLx4YHRn2x5AEJDiYYzZ3TzdzWsrz8dgaz2kHR2jsWh35aZoL97tw1RRTHK6ZQYq",\n      "signer_id": "serhii.near"\n    },\n    "transaction_outcome": {\n      "block_hash": "7YUgyBHgmbGy1edhaWRZeBVq9zzbnzrRGtVRQS5PpooW",\n      "id": "CKHzodHvFw4C87PazsniycYZZHm37CEWLE2u8VUUMU7r",\n      "outcome": {\n        "executor_id": "serhii.near",\n        "gas_burnt": 2428084223182,\n        "logs": [],\n        "receipt_ids": [\n          "5bdBKwS1RH7wm8eoG6ZeESdhNpj9HffUcf8RoP6Ng5d"\n        ],\n        "status": {\n          "SuccessReceiptId": "5bdBKwS1RH7wm8eoG6ZeESdhNpj9HffUcf8RoP6Ng5d"\n        },\n        "tokens_burnt": "242808422318200000000"\n      },\n      "proof": [\n        {\n          "direction": "Right",\n          "hash": "Agyg5P46kSVa4ptG9spteHpZ5c8XkvfbmDN5EUXhC1Wr"\n        },\n        {\n          "direction": "Right",\n          "hash": "3JDKkLCy5bJaAU3exa66sotTwJyGwyChxeNJgKReKw34"\n        },\n        {\n          "direction": "Right",\n          "hash": "7GXEmeQEJdd4c2kgN7NoYiF2bkjzV4bNkMmkhpK14NTz"\n        }\n      ]\n    }\n  }\n}\n'))),(0,r.kt)("p",null,"Was the fungible token transfer successful?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Look for ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"transaction_outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"outcome")," \xbb see if ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId")," is a key"),(0,r.kt)("li",{parentName:"ul"},"if ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId")," is not a key, this fungible token transfer has ",(0,r.kt)("inlineCode",{parentName:"li"},"failed"),"."),(0,r.kt)("li",{parentName:"ul"},"If it does have that key, get the value, which is a ",(0,r.kt)("inlineCode",{parentName:"li"},"receipt ID")),(0,r.kt)("li",{parentName:"ul"},"Loop through ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"receipts_outcome")," until you find an object that ID (from above) under the id key"),(0,r.kt)("li",{parentName:"ul"},"in that object check ",(0,r.kt)("inlineCode",{parentName:"li"},"outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"status")," \xbb (see if SuccessValue is a key)"),(0,r.kt)("li",{parentName:"ul"},"If SuccessValue is a key, fungible token transfer succeeded, if not, it failed.")),(0,r.kt)("p",null,"To determine how many fungible tokens were transferred, look at:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"transaction")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"actions")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"FunctionCall")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"args")),(0,r.kt)("li",{parentName:"ul"},"then take the args and ",(0,r.kt)("inlineCode",{parentName:"li"},"base64")," decode it, that will give you a JSON payload and look for the ",(0,r.kt)("inlineCode",{parentName:"li"},"amount")," key"),(0,r.kt)("li",{parentName:"ul"},"It will contain a stringified number that represents the number of fungible tokens that were successfully transferred")),(0,r.kt)("h2",{id:"transfer-and-call"},"Transfer and call"),(0,r.kt)("p",null,'If the idea of a fungible token using "transfer and call" is new, please review the comments above the function in ',(0,r.kt)("a",{parentName:"p",href:"https://nomicon.io/Standards/FungibleToken/Core.html#reference-level-explanation"},"the Nomicon spec"),". Also, see a similar idea ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ethereum/EIPs/issues/677"},"from EIP-677"),"."),(0,r.kt)("p",null,"For this example we will build and deploy FT contracts from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/near/near-sdk-rs/tree/master/examples/fungible-token"},"near-sdk-rs/examples/fungible-token"),"."),(0,r.kt)("p",null,"Let's call ",(0,r.kt)("inlineCode",{parentName:"p"},"ft_transfer_call")," function on ",(0,r.kt)("inlineCode",{parentName:"p"},"ft")," contract (receiver) and examine successful and unsuccessful scenarios."),(0,r.kt)("h3",{id:"successful-transfer-and-call"},"Successful transfer and call"),(0,r.kt)("p",null,"  Let's send 10 N to ",(0,r.kt)("inlineCode",{parentName:"p"},"DEFI")," contract that requires only 9 N."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"using NEAR CLI"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'near call <ft_contract_id> ft_transfer_call \'{"receiver_id": "<defi_contract_id>", "amount": "10", "msg": "take-my-money"}\' --accountId <user_account_id> --amount 0.000000000000000000000001\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"with JSON RPC call"))),(0,r.kt)("p",null,"Transaction representation:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'Transaction: {\n    block_hash: `456\u2026abc`,\n    signer_id: "serhii.testnet",\n    public_key: "ed25519:789\u2026def",\n    nonce: 123,\n    receiver_id: "dev-1623333795623-21399959778159",\n    actions: [\n        FunctionCall(\n            FunctionCallAction {\n                method_name: ft_transfer_call,\n                args: `{"receiver_id":"dev-1623693121955-71667632531176","amount":"10","msg":"take-my-money"}`,\n                gas: 300000000000000,\n                deposit: 1,\n            },\n        ),\n    ]\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```bash\n  http post https://rpc.testnet.near.org jsonrpc=2.0 id=dontcare method=broadcast_tx_commit \\\n  params:='[\"DgAAAHNlcmhpaS50ZXN0bmV0AEKEp54fyVkp8dJE2l/m1ErjdhDGodBK8ZF6JLeHFMeZqPqoVEgrAAAgAAAAZGV2LTE2MjMzMzM3OTU2MjMtMjEzOTk5NTk3NzgxNTn9j4g2IJ8nGQ38i3+k+4WBAeJL1xP7ygQhC7CrvEG4NQEAAAACEAAAAGZ0X3RyYW5zZmVyX2NhbGxWAAAAeyJyZWNlaXZlcl9pZCI6ImRldi0xNjIzNjkzMTIxOTU1LTcxNjY3NjMyNTMxMTc2IiwiYW1vdW50IjoiMTAiLCJtc2ciOiJ0YWtlLW15LW1vbmV5In0AQHoQ81oAAAEAAAAAAAAAAAAAAAAAAAAANY2lHqJlAJYNDGEQiUNnmfiBV44Q1sdg45xNlNvlROOM+AtN1z3PSJqM6M6jAKXUwANoQTzFqXhIMHIjIPbTAA==\"]'\n```\n")),(0,r.kt)("p",null,"To get details of this transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://archival-rpc.testnet.near.org jsonrpc=2.0 method=EXPERIMENTAL_tx_status \\\n    params:=\'["5n1kwA3TQQyFTkddR2Jau3H1Pt8ebQNGaov6aCQ6TDp1", "serhii.testnet"]\' id=myid\n')),(0,r.kt)("details",null,(0,r.kt)("summary",null,"**Example Response:**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "myid",\n  "jsonrpc": "2.0",\n  "result": {\n    "receipts": [\n      {\n        "predecessor_id": "serhii.testnet",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "eyJyZWNlaXZlcl9pZCI6ImRldi0xNjIzNjkzMTIxOTU1LTcxNjY3NjMyNTMxMTc2IiwiYW1vdW50IjoiMTAiLCJtc2ciOiJ0YWtlLW15LW1vbmV5In0=",\n                  "deposit": "1",\n                  "gas": 100000000000000,\n                  "method_name": "ft_transfer_call"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "Hw6z8kJ7CSaC6SgyQzcmXzNX9gq1gaAnLS169qgyZ2Vk",\n        "receiver_id": "dev-1623333795623-21399959778159"\n      },\n      {\n        "predecessor_id": "dev-1623333795623-21399959778159",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "eyJzZW5kZXJfaWQiOiJzZXJoaWkudGVzdG5ldCIsImFtb3VudCI6IjEwIiwibXNnIjoidGFrZS1teS1tb25leSJ9",\n                  "deposit": "0",\n                  "gas": 70000000000000,\n                  "method_name": "ft_on_transfer"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [\n              {\n                "data_id": "EiDQi54XHfdD1KEcgiNzogXxXuwTpzeQfmyqVwbq7H4D",\n                "receiver_id": "dev-1623333795623-21399959778159"\n              }\n            ],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "EB69xtJiLRh9RNzAHgBGmom8551hrK2xSRreqbjvJgu5",\n        "receiver_id": "dev-1623693121955-71667632531176"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "13116953530949529501760"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "AkwgvxUspRgy255fef2hrEWMbrMWFtnTRGduSgDRdSW1",\n        "receiver_id": "serhii.testnet"\n      },\n      {\n        "predecessor_id": "dev-1623333795623-21399959778159",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "eyJzZW5kZXJfaWQiOiJzZXJoaWkudGVzdG5ldCIsInJlY2VpdmVyX2lkIjoiZGV2LTE2MjM2OTMxMjE5NTUtNzE2Njc2MzI1MzExNzYiLCJhbW91bnQiOiIxMCJ9",\n                  "deposit": "0",\n                  "gas": 5000000000000,\n                  "method_name": "ft_resolve_transfer"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [\n              "EiDQi54XHfdD1KEcgiNzogXxXuwTpzeQfmyqVwbq7H4D"\n            ],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "4Tc8MsrJZSMpNZx7u4jSqxr3WhRzqxaNHxLJFqz8tUPR",\n        "receiver_id": "dev-1623333795623-21399959778159"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "761030677610514102464"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "9rxcC9o8x4RX7ftsDCfxK8qnisYv45rA1HGPxhuukWUL",\n        "receiver_id": "serhii.testnet"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "2137766093631769060520"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "H7YWFkvx16Efy2keCQ7BQ67BMEsdgdYLqJ99G4H3dR1D",\n        "receiver_id": "serhii.testnet"\n      }\n    ],\n    "receipts_outcome": [\n      {\n        "block_hash": "B9yZz1w3yzrqQnfBFAf17S4TLaHakXJWqmFDBbFxaEiZ",\n        "id": "Hw6z8kJ7CSaC6SgyQzcmXzNX9gq1gaAnLS169qgyZ2Vk",\n        "outcome": {\n          "executor_id": "dev-1623333795623-21399959778159",\n          "gas_burnt": 20612680932083,\n          "logs": [\n            "Transfer 10 from serhii.testnet to dev-1623693121955-71667632531176"\n          ],\n          "receipt_ids": [\n            "EB69xtJiLRh9RNzAHgBGmom8551hrK2xSRreqbjvJgu5",\n            "4Tc8MsrJZSMpNZx7u4jSqxr3WhRzqxaNHxLJFqz8tUPR",\n            "H7YWFkvx16Efy2keCQ7BQ67BMEsdgdYLqJ99G4H3dR1D"\n          ],\n          "status": {\n            "SuccessReceiptId": "4Tc8MsrJZSMpNZx7u4jSqxr3WhRzqxaNHxLJFqz8tUPR"\n          },\n          "tokens_burnt": "2061268093208300000000"\n        },\n        "proof": []\n      },\n      {\n        "block_hash": "7Z4LHWksvw7sKYKwpQfjEMG8oigjtRXKa3EopN7hS2v7",\n        "id": "EB69xtJiLRh9RNzAHgBGmom8551hrK2xSRreqbjvJgu5",\n        "outcome": {\n          "executor_id": "dev-1623693121955-71667632531176",\n          "gas_burnt": 3568066327145,\n          "logs": [\n            "Sender @serhii.testnet is transferring 10 tokens using ft_on_transfer, msg = take-my-money"\n          ],\n          "receipt_ids": [\n            "AkwgvxUspRgy255fef2hrEWMbrMWFtnTRGduSgDRdSW1"\n          ],\n          "status": {\n            "SuccessValue": "IjEi"\n          },\n          "tokens_burnt": "356806632714500000000"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "5X2agUKpqmk7QkUZsDQ4R4HdX7zXeuPYpVAfvbmF5Gav"\n          }\n        ]\n      },\n      {\n        "block_hash": "CrSDhQNn72K2Qr1mmoM9j3YHCo3wfZdmHjpHJs74WnPk",\n        "id": "AkwgvxUspRgy255fef2hrEWMbrMWFtnTRGduSgDRdSW1",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "4WG6hF5fTAtM7GSqU8mprrFwRVbChGMCV2NPZEjEdnc1"\n          }\n        ]\n      },\n      {\n        "block_hash": "CrSDhQNn72K2Qr1mmoM9j3YHCo3wfZdmHjpHJs74WnPk",\n        "id": "4Tc8MsrJZSMpNZx7u4jSqxr3WhRzqxaNHxLJFqz8tUPR",\n        "outcome": {\n          "executor_id": "dev-1623333795623-21399959778159",\n          "gas_burnt": 6208280264404,\n          "logs": [\n            "Refund 1 from dev-1623693121955-71667632531176 to serhii.testnet"\n          ],\n          "receipt_ids": [\n            "9rxcC9o8x4RX7ftsDCfxK8qnisYv45rA1HGPxhuukWUL"\n          ],\n          "status": {\n            "SuccessValue": "Ijki"\n          },\n          "tokens_burnt": "620828026440400000000"\n        },\n        "proof": [\n          {\n            "direction": "Left",\n            "hash": "BzT8YhEDDWSuoGGTBzH2Cj5GC4c56uAQxk41by4KVnXi"\n          }\n        ]\n      },\n      {\n        "block_hash": "3Q2Zyscj6vG5nC2vdoYfcBHU9RVaAwoxHsHzAKVcAHZ6",\n        "id": "9rxcC9o8x4RX7ftsDCfxK8qnisYv45rA1HGPxhuukWUL",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": []\n      },\n      {\n        "block_hash": "7Z4LHWksvw7sKYKwpQfjEMG8oigjtRXKa3EopN7hS2v7",\n        "id": "H7YWFkvx16Efy2keCQ7BQ67BMEsdgdYLqJ99G4H3dR1D",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Left",\n            "hash": "61ak42D3duBBunCz3w4xXxoEeR2N7oav5e938TnmGFGN"\n          }\n        ]\n      }\n    ],\n    "status": {\n      "SuccessValue": "Ijki"\n    },\n    "transaction": {\n      "actions": [\n        {\n          "FunctionCall": {\n            "args": "eyJyZWNlaXZlcl9pZCI6ImRldi0xNjIzNjkzMTIxOTU1LTcxNjY3NjMyNTMxMTc2IiwiYW1vdW50IjoiMTAiLCJtc2ciOiJ0YWtlLW15LW1vbmV5In0=",\n            "deposit": "1",\n            "gas": 100000000000000,\n            "method_name": "ft_transfer_call"\n          }\n        }\n      ],\n      "hash": "5n1kwA3TQQyFTkddR2Jau3H1Pt8ebQNGaov6aCQ6TDp1",\n      "nonce": 47589658000040,\n      "public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN",\n      "receiver_id": "dev-1623333795623-21399959778159",\n      "signature": "ed25519:256qp2jAGXhhw2t2XfUAjWwzz3XcD83DH2v9THwDPsZjCLWHU8QJd6cuA773NP9yBmTd2ZyYiFHuxVEkYqnbsaSb",\n      "signer_id": "serhii.testnet"\n    },\n    "transaction_outcome": {\n      "block_hash": "96k8kKzFuZWxyiUnT774Rg7DC3XDZNuxhxD1qEViFupd",\n      "id": "5n1kwA3TQQyFTkddR2Jau3H1Pt8ebQNGaov6aCQ6TDp1",\n      "outcome": {\n        "executor_id": "serhii.testnet",\n        "gas_burnt": 2428149065268,\n        "logs": [],\n        "receipt_ids": [\n          "Hw6z8kJ7CSaC6SgyQzcmXzNX9gq1gaAnLS169qgyZ2Vk"\n        ],\n        "status": {\n          "SuccessReceiptId": "Hw6z8kJ7CSaC6SgyQzcmXzNX9gq1gaAnLS169qgyZ2Vk"\n        },\n        "tokens_burnt": "242814906526800000000"\n      },\n      "proof": []\n    }\n  }\n}\n'))),(0,r.kt)("p",null,"Now, let's try to follow the steps described in the previous section and determine if these transactions was successful. In addition to being successful, let's analyze the various receipts in the series of cross-contract calls to determine how many fungible tokens were transferred. This will be the most complex case we'll look at."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Check that ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"transaction_outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"status")," has ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId")," as a key. If not, no fungible tokens were transferred."),(0,r.kt)("li",{parentName:"ol"},"Take the value of the ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId")," key. In the case above it's ",(0,r.kt)("inlineCode",{parentName:"li"},"Hw6z8kJ7CSaC6SgyQzcmXzNX9gq1gaAnLS169qgyZ2Vk"),"."),(0,r.kt)("li",{parentName:"ol"},"Now, under ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"receipts")," loop through the array until you find a receipt where the ",(0,r.kt)("inlineCode",{parentName:"li"},"receipt_id")," matches the value from step 2. (Note that in the receipt, under ",(0,r.kt)("inlineCode",{parentName:"li"},"Actions")," there's an element mentioning calling the ",(0,r.kt)("inlineCode",{parentName:"li"},'method_name: "ft_transfer_call"'),".) On the same level of JSON, there's an ",(0,r.kt)("inlineCode",{parentName:"li"},"args")," key. That's a base64-encoded value of the arguments passed to the method. When decoded it is:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{"receiver_id":"dev-1623693121955-71667632531176","amount":"10","msg":"take-my-money"}\n')),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Loop through ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"receipts_outcome")," until finding the object where ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," is equal to the value from step 2. Similar to step 1, this object will also contain a ",(0,r.kt)("inlineCode",{parentName:"li"},"status")," field that should contain the key ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId"),". Again, if this isn't there no fungible tokens were transferred, otherwise get the value of the ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId"),". In the above example, this value is ",(0,r.kt)("inlineCode",{parentName:"li"},"4Tc8MsrJZSMpNZx7u4jSqxr3WhRzqxaNHxLJFqz8tUPR"),"."),(0,r.kt)("li",{parentName:"ol"},"Similar to the previous step, loop through the ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"receipts_outcome")," until you find the object where the ",(0,r.kt)("inlineCode",{parentName:"li"},"id")," matches the value from step 4. In that object check that ",(0,r.kt)("inlineCode",{parentName:"li"},"outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"status")," has the ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessValue")," field. This ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessValue"),' represents how many fungible tokens the receiving contract is "returning" to the fungible token contract. Note that in the example above the value is ',(0,r.kt)("inlineCode",{parentName:"li"},"Ijki"),", which is the base64-encoded version of ",(0,r.kt)("inlineCode",{parentName:"li"},'"9"'),". At this point, we know that 10 fungible tokens were sent (from step 3) and 9 were taken.")),(0,r.kt)("p",null,"For additional clarity, let's take a look at one more optional aspect. In step 4 we isolated an obeject in ",(0,r.kt)("inlineCode",{parentName:"p"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"p"},"receipts_outcome"),". There's an array of ",(0,r.kt)("inlineCode",{parentName:"p"},"receipt_ids")," that's particularly interesting. The first element in the array is the receipt ID ",(0,r.kt)("inlineCode",{parentName:"p"},"EB69xtJiLRh9RNzAHgBGmom8551hrK2xSRreqbjvJgu5"),". If we loop through the ",(0,r.kt)("inlineCode",{parentName:"p"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"p"},"receipts_outcome")," and find this as the value for the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," key, we'll see what happened in the function ",(0,r.kt)("inlineCode",{parentName:"p"},"ft_on_transfer")," which takes place in the contract receiving the fungible tokens. In this object the ",(0,r.kt)("inlineCode",{parentName:"p"},"status")," \xbb ",(0,r.kt)("inlineCode",{parentName:"p"},"SuccessValue")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"IjEi")," which is the base64-encoded value of ",(0,r.kt)("inlineCode",{parentName:"p"},'"1"'),"."),(0,r.kt)("p",null,"In summary:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A user called the fungible token contract with the method ",(0,r.kt)("inlineCode",{parentName:"li"},"ft_transfer_call")," specifying the receiver account, how many tokens to send, and custom info."),(0,r.kt)("li",{parentName:"ol"},"The receiver account implemented ",(0,r.kt)("inlineCode",{parentName:"li"},"ft_on_transfer"),", returning ",(0,r.kt)("inlineCode",{parentName:"li"},'"1"')," to the callback function on the fungible token contract."),(0,r.kt)("li",{parentName:"ol"},"The fungible token contract's callback is ",(0,r.kt)("inlineCode",{parentName:"li"},"ft_resolve_transfer")," and receives this value of ",(0,r.kt)("inlineCode",{parentName:"li"},'"1"'),". It knows that 1 token was returned, so subtracts that from the 10 it intended to send. It then returns to the user how many tokens were used in this back-and-forth series of cross-contract calls: ",(0,r.kt)("inlineCode",{parentName:"li"},'"9"'),".")),(0,r.kt)("h3",{id:"failed-transfer-and-call"},"Failed transfer and call"),(0,r.kt)("p",null,"Let's try to send more tokens than the account has:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"using NEAR CLI",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'    near call <ft_contract_id> ft_transfer_call \'{"receiver_id": "<defi_contract_id>", "amount": "1000000000", "msg": "take-my-money"}\' --accountId <user_account_id> --amount 0.000000000000000000000001\n')))),(0,r.kt)("p",null,"Transaction representation:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'Transaction: {\n    block_hash: `456\u2026abc`,\n    signer_id: "serhii.testnet",\n    public_key: "ed25519:789\u2026def",\n    nonce: 123,\n    receiver_id: "dev-1623333795623-21399959778159",\n    actions: [\n        FunctionCall(\n            FunctionCallAction {\n                method_name: ft_transfer_call,\n                args: `{"receiver_id":"dev-1623333916368-58707434878533","amount":"1000000000","msg":"take-my-money"}`,\n                gas: 300000000000000,\n                deposit: 1,\n            },\n        ),\n    ]\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"with JSON RPC call",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"    http post https://rpc.testnet.near.org jsonrpc=2.0 id=dontcare method=broadcast_tx_commit \\\n    params:='[\"DgAAAHNlcmhpaS50ZXN0bmV0AEKEp54fyVkp8dJE2l/m1ErjdhDGodBK8ZF6JLeHFMeZn/qoVEgrAAAgAAAAZGV2LTE2MjMzMzM3OTU2MjMtMjEzOTk5NTk3NzgxNTnrbOQ93Wv9xxBwmq4yDYrssCpwKSI2bzjNNCCCHMZKNwEAAAACEAAAAGZ0X3RyYW5zZmVyX2NhbGxeAAAAeyJyZWNlaXZlcl9pZCI6ImRldi0xNjIzMzMzOTE2MzY4LTU4NzA3NDM0ODc4NTMzIiwiYW1vdW50IjoiMTAwMDAwMDAwMCIsIm1zZyI6InRha2UtbXktbW9uZXkifQBAehDzWgAAAQAAAAAAAAAAAAAAAAAAAABQh3k+7zG2m/Yz3O/FBrvLaBwR/5YRB5FbFnb27Nfu6BW/Wh77RFH7+ktBwGLBwFbJGxiumIcsqBiGXgg1EPMN\"]'\n")))),(0,r.kt)("p",null,"To get details of this transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'http post https://archival-rpc.testnet.near.org jsonrpc=2.0 method=EXPERIMENTAL_tx_status \\\n    params:=\'["FQsh44pvEsK8RS9AbK868CmGwfhUU2pUrizkQ6wCWTsB", "serhii.testnet"]\' id=myid\n')),(0,r.kt)("details",null,(0,r.kt)("summary",null,"**Example response**:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "myid",\n  "jsonrpc": "2.0",\n  "result": {\n    "receipts": [\n      {\n        "predecessor_id": "serhii.testnet",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "FunctionCall": {\n                  "args": "eyJyZWNlaXZlcl9pZCI6ImRldi0xNjIzMzMzOTE2MzY4LTU4NzA3NDM0ODc4NTMzIiwiYW1vdW50IjoiMTAwMDAwMDAwMCIsIm1zZyI6InRha2UtbXktbW9uZXkifQ==",\n                  "deposit": "1",\n                  "gas": 100000000000000,\n                  "method_name": "ft_transfer_call"\n                }\n              }\n            ],\n            "gas_price": "186029458",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "83AdQ16bpAC7BEUyF7zoRsAgeNW7HHmjhZLvytEsrygo",\n        "receiver_id": "dev-1623333795623-21399959778159"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "1"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "system",\n            "signer_public_key": "ed25519:11111111111111111111111111111111"\n          }\n        },\n        "receipt_id": "Euy4Q33DfvJTXD8HirE5ACoXnw9PMTQ2Hq47aGyD1spc",\n        "receiver_id": "serhii.testnet"\n      },\n      {\n        "predecessor_id": "system",\n        "receipt": {\n          "Action": {\n            "actions": [\n              {\n                "Transfer": {\n                  "deposit": "18681184841157733814920"\n                }\n              }\n            ],\n            "gas_price": "0",\n            "input_data_ids": [],\n            "output_data_receivers": [],\n            "signer_id": "serhii.testnet",\n            "signer_public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN"\n          }\n        },\n        "receipt_id": "6ZDoSeV3gLFS2NXqMCJGEUR3VwBpSxBEPjnEEaAQfmXL",\n        "receiver_id": "serhii.testnet"\n      }\n    ],\n    "receipts_outcome": [\n      {\n        "block_hash": "BohRBwqjRHssDVS9Gt9dj3SYuipxHA81xXFjRVLqgGeb",\n        "id": "83AdQ16bpAC7BEUyF7zoRsAgeNW7HHmjhZLvytEsrygo",\n        "outcome": {\n          "executor_id": "dev-1623333795623-21399959778159",\n          "gas_burnt": 3734715409940,\n          "logs": [],\n          "receipt_ids": [\n            "Euy4Q33DfvJTXD8HirE5ACoXnw9PMTQ2Hq47aGyD1spc",\n            "6ZDoSeV3gLFS2NXqMCJGEUR3VwBpSxBEPjnEEaAQfmXL"\n          ],\n          "status": {\n            "Failure": {\n              "ActionError": {\n                "index": 0,\n                "kind": {\n                  "FunctionCallError": {\n                    "ExecutionError": "Smart contract panicked: The account doesn\'t have enough balance"\n                  }\n                }\n              }\n            }\n          },\n          "tokens_burnt": "373471540994000000000"\n        },\n        "proof": []\n      },\n      {\n        "block_hash": "4BzTmMmTjKvfs6ANS5gmJ6GQzhqianEGWq7SaxSfPbdC",\n        "id": "Euy4Q33DfvJTXD8HirE5ACoXnw9PMTQ2Hq47aGyD1spc",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Right",\n            "hash": "5ipmcdgTieQqFXWQFCwcbZhFtkHE4PL4nW3mknBchpG6"\n          }\n        ]\n      },\n      {\n        "block_hash": "4BzTmMmTjKvfs6ANS5gmJ6GQzhqianEGWq7SaxSfPbdC",\n        "id": "6ZDoSeV3gLFS2NXqMCJGEUR3VwBpSxBEPjnEEaAQfmXL",\n        "outcome": {\n          "executor_id": "serhii.testnet",\n          "gas_burnt": 0,\n          "logs": [],\n          "receipt_ids": [],\n          "status": {\n            "SuccessValue": ""\n          },\n          "tokens_burnt": "0"\n        },\n        "proof": [\n          {\n            "direction": "Left",\n            "hash": "9tcjij6M8Ge4aJcAa97He5nw8pH7PF8ZjRHVahBZD2VW"\n          }\n        ]\n      }\n    ],\n    "status": {\n      "Failure": {\n        "ActionError": {\n          "index": 0,\n          "kind": {\n            "FunctionCallError": {\n              "ExecutionError": "Smart contract panicked: The account doesn\'t have enough balance"\n            }\n          }\n        }\n      }\n    },\n    "transaction": {\n      "actions": [\n        {\n          "FunctionCall": {\n            "args": "eyJyZWNlaXZlcl9pZCI6ImRldi0xNjIzMzMzOTE2MzY4LTU4NzA3NDM0ODc4NTMzIiwiYW1vdW50IjoiMTAwMDAwMDAwMCIsIm1zZyI6InRha2UtbXktbW9uZXkifQ==",\n            "deposit": "1",\n            "gas": 100000000000000,\n            "method_name": "ft_transfer_call"\n          }\n        }\n      ],\n      "hash": "FQsh44pvEsK8RS9AbK868CmGwfhUU2pUrizkQ6wCWTsB",\n      "nonce": 47589658000031,\n      "public_key": "ed25519:5UfEFyve3RdqKkWtALMreA9jzsAGDgCtwEXGNtkGeruN",\n      "receiver_id": "dev-1623333795623-21399959778159",\n      "signature": "ed25519:2cPASnxKtCoQtZ9NFq63fg8RzpjvmmE8hL4s2jk8zuhnBCD3AnYQ6chZZrUBGwu7WrsGuWUyohP1bEca4vfbsorC",\n      "signer_id": "serhii.testnet"\n    },\n    "transaction_outcome": {\n      "block_hash": "FwHUeqmYpvgkL7eBrUUAEMCuaQshcSy5vm4AHchebhK1",\n      "id": "FQsh44pvEsK8RS9AbK868CmGwfhUU2pUrizkQ6wCWTsB",\n      "outcome": {\n        "executor_id": "serhii.testnet",\n        "gas_burnt": 2428166952740,\n        "logs": [],\n        "receipt_ids": [\n          "83AdQ16bpAC7BEUyF7zoRsAgeNW7HHmjhZLvytEsrygo"\n        ],\n        "status": {\n          "SuccessReceiptId": "83AdQ16bpAC7BEUyF7zoRsAgeNW7HHmjhZLvytEsrygo"\n        },\n        "tokens_burnt": "242816695274000000000"\n      },\n      "proof": []\n    }\n  }\n}\n'))),(0,r.kt)("p",null,"Let's examine this response."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"transaction_outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"status")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"SuccessReceiptId")," is ",(0,r.kt)("inlineCode",{parentName:"li"},"83AdQ16bpAC7BEUyF7zoRsAgeNW7HHmjhZLvytEsrygo")),(0,r.kt)("li",{parentName:"ul"},"check ",(0,r.kt)("inlineCode",{parentName:"li"},"result")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"receipts_outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"0")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"outcome")," \xbb ",(0,r.kt)("inlineCode",{parentName:"li"},"status")," and find ",(0,r.kt)("inlineCode",{parentName:"li"},"Failure")," status there")),(0,r.kt)("admonition",{title:"Got a question?",type:"tip"},(0,r.kt)("a",{href:"https://stackoverflow.com/questions/tagged/nearprotocol"},(0,r.kt)("h8",null,"Ask it on StackOverflow!"))))}m.isMDXComponent=!0}}]);